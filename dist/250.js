"use strict";(self.webpackChunkBrainDriveChatWithDocs=self.webpackChunkBrainDriveChatWithDocs||[]).push([[250],{2146:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"/* Dark theme variables */\n.dark-theme {\n  --bg-color: #121a28;\n  --paper-bg: #1a2332;\n  --text-color: #e0e0e0;\n  --border-color: rgba(255, 255, 255, 0.1);\n  --hover-color: rgba(255, 255, 255, 0.1);\n  --input-bg: #1e293b;\n  --button-primary-bg: #2196f3;\n  --button-primary-text: #ffffff;\n  --button-secondary-bg: #2c3a4f;\n  --button-secondary-text: #ffffff;\n  --button-danger-bg: #f44336;\n  --button-danger-text: #ffffff;\n  --status-success-color: #4caf50;\n  --status-error-color: #f44336;\n  --status-checking-color: #ff9800;\n  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.3);\n  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4);\n  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5);\n  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.6);\n}\n\n/* Dark theme adjustments for icons */\n.dark-theme .header-icon-only:hover:not(:disabled) {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.dark-theme .header-icon-danger:hover:not(:disabled) {\n  background-color: rgba(244, 67, 54, 0.15);\n}\n\n.dark-theme .header-icon-streaming.active:hover:not(:disabled) {\n  background-color: rgba(33, 150, 243, 0.15);\n}\n\n.dark-theme .header-icon-streaming.inactive:hover:not(:disabled) {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n/* Dark theme adjustments for scroll button */\n.dark-theme .scroll-to-bottom-button {\n  background-color: rgba(33, 150, 243, 0.85);\n  color: #ffffff;\n  box-shadow: 0 16px 34px rgba(8, 47, 73, 0.55);\n}\n\n.dark-theme .scroll-to-bottom-button:hover {\n  box-shadow: 0 20px 40px rgba(8, 47, 73, 0.6);\n}\n\n/* Dark theme adjustments for message bubbles */\n.dark-theme .message-ai .message-bubble {\n  background-color: rgba(255, 255, 255, 0.04);\n  border-color: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 12px 34px rgba(8, 47, 73, 0.55);\n}\n\n.dark-theme .message-user .message-bubble {\n  background-color: rgba(33, 150, 243, 0.2);\n  border-color: rgba(33, 150, 243, 0.35);\n  color: var(--text-color);\n}\n\n/* Dark theme adjustments for message actions */\n.dark-theme .message-action-btn {\n  background-color: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.16);\n}\n\n.dark-theme .message-action-btn:hover {\n  background-color: rgba(33, 150, 243, 0.25);\n  border-color: rgba(33, 150, 243, 0.45);\n}\n\n.dark-theme .message-edit-input {\n  background-color: var(--bg-color);\n  border-color: var(--button-primary-bg);\n}\n\n/* Dark theme adjustments for search results */\n.dark-theme .message-search-results .message-bubble {\n  background-color: rgba(33, 150, 243, 0.12);\n  border-color: rgba(33, 150, 243, 0.32);\n}\n\n.dark-theme .search-result-item {\n  background-color: var(--bg-color);\n}\n\n.dark-theme .search-toggle-btn:hover {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.dark-theme .scraping-summary {\n  background-color: rgba(76, 175, 80, 0.1);\n  border-color: rgba(76, 175, 80, 0.3);\n}\n\n/* Dark theme adjustments for document context */\n.dark-theme .message-document-context .message-bubble {\n  background-color: rgba(76, 175, 80, 0.12);\n  border-color: rgba(76, 175, 80, 0.3);\n}\n\n.dark-theme .document-toggle-btn:hover {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.dark-theme .document-content {\n  background-color: var(--bg-color);\n}\n\n/* Dark theme adjustments for conversation menu */\n.dark-theme .conversation-menu-item.datetime {\n  background-color: rgba(255, 255, 255, 0.02);\n}\n\n/* Dark theme adjustments for history items */\n.dark-theme .history-item.active {\n  background-color: rgba(33, 150, 243, 0.08);\n}\n\n/* Dark theme adjustments for markdown */\n.dark-theme .markdown-inline-code {\n  background-color: rgba(255, 255, 255, 0.08);\n  color: #f8bbd9;\n  border-color: rgba(255, 255, 255, 0.15);\n}\n\n.dark-theme .markdown-code-block {\n  background-color: rgba(255, 255, 255, 0.05);\n  border-color: rgba(255, 255, 255, 0.1);\n}\n\n.dark-theme .markdown-blockquote {\n  background-color: rgba(33, 150, 243, 0.1);\n}\n\n.dark-theme .markdown-table-header {\n  background-color: rgba(255, 255, 255, 0.05);\n}\n\n/* Dark theme adjustments for enhanced code blocks */\n.dark-theme .enhanced-code-block .code-block-header {\n  background-color: rgba(255, 255, 255, 0.05);\n}\n\n.dark-theme .code-block-content .react-syntax-highlighter {\n  background-color: rgba(255, 255, 255, 0.02) !important;\n}\n\n.dark-theme .raw-markdown-content {\n  background-color: rgba(255, 255, 255, 0.02);\n}\n\n/* Dark theme adjustments for thinking blocks */\n.dark-theme .message-body .thinking-block {\n  background-color: rgba(33, 150, 243, 0.12);\n  border-color: rgba(33, 150, 243, 0.35);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.dark-theme .message-body .thinking-block .thinking-header {\n  background-color: rgba(33, 150, 243, 0.16);\n}\n",""]);const i=s},2460:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"/* Component-specific styles for BrainDriveChat */\n\n/* Redesigned Chat Header Styles */\n.chat-header-redesigned {\n  display: grid;\n  /* Allow Model and Persona to sit side-by-side before the flexible spacer */\n  grid-template-columns: auto auto 1fr auto;\n  align-items: flex-start;\n  padding: 1rem 1.25rem;\n  border-bottom: 1px solid var(--border-color);\n  background-color: var(--paper-bg);\n  flex-shrink: 0;\n  gap: 1.5rem;\n  min-height: 64px;\n}\n\n.header-model-section {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  justify-self: start;\n  min-width: 340px;\n}\n\n.header-persona-section {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  justify-self: start;\n}\n\n.header-history-section {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  justify-self: center;\n  min-width: 0;\n  max-width: 500px;\n  width: 100%;\n}\n\n.header-actions-section {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  justify-self: end;\n}\n\n.header-new-chat-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  padding: 0.5rem;\n  background-color: var(--button-primary-bg);\n  color: var(--button-primary-text);\n  border: none;\n  border-radius: 0.375rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.header-new-chat-button:hover:not(:disabled) {\n  opacity: 0.9;\n  transform: translateY(-1px);\n  box-shadow: var(--shadow-sm);\n}\n\n.header-new-chat-button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none;\n}\n\n.header-label {\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: var(--text-color);\n  white-space: nowrap;\n  opacity: 0.8;\n  min-width: fit-content;\n}\n\n.header-loading {\n  font-size: 0.875rem;\n  color: var(--text-color);\n  opacity: 0.7;\n}\n\n.header-select {\n  padding: 0.5rem 0.75rem;\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  background-color: var(--input-bg);\n  color: var(--text-color);\n  font-size: 0.875rem;\n  transition: border-color 0.2s ease, box-shadow 0.2s ease;\n  min-height: 40px;\n}\n\n.header-select:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n.header-model-section .searchable-dropdown {\n  flex: 1 0 auto;\n  min-width: 320px;\n}\n\n.header-model-section .searchable-dropdown-trigger,\n.header-model-section .header-select {\n  min-width: 320px;\n  max-width: 420px;\n  flex-shrink: 0;\n}\n\n.header-model-section .searchable-dropdown-menu {\n  min-width: 340px;\n  width: max-content;\n}\n\n.header-persona-section .header-select {\n  min-width: 140px;\n  max-width: 160px;\n}\n\n.header-select-history {\n  flex: 1;\n  min-width: 200px;\n}\n\n/* Searchable dropdown */\n.searchable-dropdown {\n  position: relative;\n  min-width: 0;\n}\n\n.searchable-dropdown.disabled {\n  pointer-events: none;\n}\n\n.searchable-dropdown-trigger {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n  width: 100%;\n  background-color: var(--input-bg);\n  color: var(--text-color);\n}\n\n.searchable-dropdown-trigger:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n.searchable-dropdown-value {\n  flex: 1;\n  min-width: 0;\n  text-align: left;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.searchable-dropdown-icon {\n  opacity: 0.6;\n  font-size: 0.75rem;\n}\n\n.searchable-dropdown-menu {\n  position: absolute;\n  z-index: 20;\n  top: calc(100% + 0.35rem);\n  left: 0;\n  right: 0;\n  background-color: var(--paper-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 0.5rem;\n  box-shadow: var(--shadow-md);\n  display: flex;\n  flex-direction: column;\n  max-height: 320px;\n  overflow: hidden;\n}\n\n.searchable-dropdown-search {\n  padding: 0.5rem;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.searchable-dropdown-input {\n  width: 100%;\n  padding: 0.4rem 0.5rem;\n  font-size: 0.875rem;\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  background-color: var(--input-bg);\n  color: var(--text-color);\n}\n\n.searchable-dropdown-input:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n.searchable-dropdown-options {\n  padding: 0.25rem 0;\n  overflow-y: auto;\n}\n\n.searchable-dropdown-option {\n  padding: 0.5rem 0.75rem;\n  font-size: 0.875rem;\n  cursor: pointer;\n  display: flex;\n  flex-direction: column;\n  gap: 0.15rem;\n}\n\n.searchable-dropdown-option-content {\n  display: flex;\n  flex-direction: column;\n  gap: 0.15rem;\n}\n\n.searchable-dropdown-option:hover,\n.searchable-dropdown-option.active {\n  background-color: rgba(33, 150, 243, 0.08);\n}\n\n.searchable-dropdown-option.selected {\n  font-weight: 600;\n}\n\n.searchable-dropdown-option.disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.searchable-dropdown-option-label {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.searchable-dropdown-option-description {\n  font-size: 0.75rem;\n  color: var(--text-muted-color, rgba(180, 190, 205, 0.75));\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.searchable-dropdown-empty {\n  padding: 0.75rem;\n  font-size: 0.8125rem;\n  color: var(--text-muted-color, rgba(0, 0, 0, 0.6));\n  text-align: center;\n}\n\n/* Icon-Only Buttons */\n.header-icon-only {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  border: none;\n  border-radius: 0.375rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  background-color: transparent;\n  color: var(--text-color);\n  opacity: 0.7;\n}\n\n.header-icon-only:hover:not(:disabled) {\n  opacity: 1;\n  background-color: var(--border-color);\n  transform: translateY(-1px);\n}\n\n.header-icon-only:disabled {\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n\n.header-icon-only:disabled:hover {\n  background-color: transparent;\n  transform: none;\n}\n\n.header-icon-danger:hover:not(:disabled) {\n  background-color: rgba(244, 67, 54, 0.1);\n  color: var(--button-danger-bg);\n}\n\n/* Streaming Toggle Icon */\n.header-icon-streaming.active {\n  color: var(--button-primary-bg);\n  opacity: 1;\n}\n\n.header-icon-streaming.inactive {\n  color: var(--text-color);\n  opacity: 0.5;\n}\n\n.header-icon-streaming.active:hover:not(:disabled) {\n  background-color: rgba(33, 150, 243, 0.1);\n  color: var(--button-primary-bg);\n}\n\n.header-icon-streaming.inactive:hover:not(:disabled) {\n  background-color: var(--border-color);\n  color: var(--text-color);\n  opacity: 0.8;\n}\n\n/* Legacy support - keep for backward compatibility */\n.header-icon-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 40px;\n  height: 40px;\n  border: none;\n  border-radius: 0.375rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\n.header-icon-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.header-icon-btn-primary {\n  background-color: var(--button-primary-bg);\n  color: var(--button-primary-text);\n}\n\n.header-icon-btn-primary:hover:not(:disabled) {\n  opacity: 0.9;\n  transform: translateY(-1px);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);\n}\n\n.header-icon-btn-secondary {\n  background-color: var(--button-secondary-bg);\n  color: var(--button-secondary-text);\n}\n\n.header-icon-btn-secondary:hover:not(:disabled) {\n  opacity: 0.9;\n  transform: translateY(-1px);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);\n}\n\n.header-icon-btn-danger {\n  background-color: var(--button-danger-bg);\n  color: var(--button-danger-text);\n}\n\n.header-icon-btn-danger:hover:not(:disabled) {\n  opacity: 0.9;\n  transform: translateY(-1px);\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);\n}\n\n/* Modern Streaming Toggle */\n.streaming-toggle {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  padding: 0.25rem;\n}\n\n.toggle-input {\n  display: none;\n}\n\n.toggle-label-modern {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  cursor: pointer;\n  user-select: none;\n}\n\n.toggle-slider {\n  position: relative;\n  width: 44px;\n  height: 24px;\n  background-color: var(--border-color);\n  border-radius: 12px;\n  transition: background-color 0.2s ease;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\n.toggle-slider::before {\n  content: '';\n  position: absolute;\n  top: 2px;\n  left: 2px;\n  width: 20px;\n  height: 20px;\n  background-color: white;\n  border-radius: 50%;\n  transition: transform 0.2s ease;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);\n}\n\n.toggle-input:checked + .toggle-label-modern .toggle-slider {\n  background-color: var(--button-primary-bg);\n}\n\n.toggle-input:checked + .toggle-label-modern .toggle-slider::before {\n  transform: translateX(20px);\n}\n\n.toggle-text {\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: var(--text-color);\n  white-space: nowrap;\n}\n\n/* Persona Selector */\n.persona-selector {\n  padding: 0.375rem 0.5rem;\n  border: 1px solid var(--border-color);\n  border-radius: 0.25rem;\n  background-color: var(--input-bg);\n  color: var(--text-color);\n  font-size: 0.75rem;\n  min-width: 120px;\n  max-width: 150px;\n  transition: border-color 0.2s ease;\n}\n\n.persona-selector:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n  box-shadow: 0 0 0 1px rgba(33, 150, 243, 0.2);\n}\n\n.persona-selector:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Input buttons */\n.input-button {\n  background-color: var(--button-secondary-bg);\n  color: var(--button-secondary-text);\n  border: none;\n  border-radius: 0.375rem;\n  width: 2rem;\n  height: 2rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  opacity: 0.7;\n}\n\n.input-button:hover:not(:disabled) {\n  opacity: 1;\n  box-shadow: var(--shadow-sm);\n}\n\n.input-button:disabled {\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n\n.input-button.send-button {\n  background-color: var(--button-primary-bg);\n  color: var(--button-primary-text);\n  opacity: 0.9;\n}\n\n.input-button.send-button:hover:not(:disabled) {\n  opacity: 1;\n  box-shadow: var(--shadow-md);\n}\n\n.input-button.send-button.stop-button {\n  background-color: var(--button-danger-bg);\n  color: var(--button-danger-text);\n}\n\n.send-button {\n  position: static; /* inline in flex row */\n  background-color: var(--button-primary-bg);\n  color: var(--button-primary-text);\n  border: none;\n  border-radius: 0.375rem; /* match input-button shape */\n  width: 2rem;\n  height: 2rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n}\n\n.send-button:hover {\n  opacity: 0.9;\n}\n\n.send-button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* New Chat Button in History Section */\n.new-chat-button-history {\n  background-color: var(--button-secondary-bg);\n  color: var(--button-secondary-text);\n  border: none;\n  border-radius: 0.375rem;\n  width: 2.5rem;\n  height: 2.5rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  opacity: 0.8;\n  flex-shrink: 0;\n}\n\n.new-chat-button-history:hover:not(:disabled) {\n  opacity: 1;\n  transform: translateY(-1px);\n  box-shadow: var(--shadow-sm);\n}\n\n.new-chat-button-history:disabled {\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n\n/* Menu Container */\n.menu-container {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n/* Dropdown Menu */\n.dropdown-menu {\n  position: absolute;\n  bottom: 100%;\n  left: 0;\n  margin-bottom: 0.5rem;\n  background-color: var(--paper-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 0.5rem;\n  box-shadow: var(--shadow-lg);\n  min-width: 180px;\n  z-index: 1000;\n  overflow: hidden;\n}\n\n.menu-item {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  width: 100%;\n  padding: 0.75rem 1rem;\n  background: none;\n  border: none;\n  color: var(--text-color);\n  cursor: pointer;\n  transition: background-color 0.2s ease;\n  font-size: 0.875rem;\n  text-align: left;\n}\n\n.menu-item:hover:not(:disabled) {\n  background-color: var(--hover-color);\n}\n\n.menu-item:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.menu-item.active {\n  background-color: rgba(33, 150, 243, 0.1);\n  color: var(--button-primary-bg);\n}\n\n.menu-item.active:hover:not(:disabled) {\n  background-color: rgba(33, 150, 243, 0.15);\n}\n\n/* Scroll to bottom button */\n.scroll-to-bottom-button {\n  position: absolute;\n  bottom: 1.5rem;\n  right: 1.25rem;\n  width: 48px;\n  height: 48px;\n  border-radius: 999px;\n  background-color: var(--button-primary-bg);\n  color: var(--button-primary-text);\n  border: none;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 14px 30px rgba(33, 150, 243, 0.3);\n  transition: transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease;\n  z-index: 15;\n  opacity: 0.92;\n}\n\n.scroll-to-bottom-button:hover {\n  opacity: 1;\n  transform: translateY(-3px);\n  box-shadow: 0 18px 36px rgba(33, 150, 243, 0.35);\n}\n\n.scroll-to-bottom-button:active {\n  transform: translateY(0);\n}\n\n.scroll-to-bottom-button:focus-visible {\n  outline: 2px solid rgba(255, 255, 255, 0.9);\n  outline-offset: 2px;\n}\n\n/* History accordion button */\n.history-accordion-button {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0;\n  transition: opacity 0.2s ease;\n}\n\n.history-accordion-button:hover {\n  opacity: 0.8;\n}\n\n.history-label {\n  font-size: 0.875rem;\n  font-weight: 500;\n  color: var(--text-color);\n  opacity: 0.8;\n  display: block;\n  margin: 0;\n  cursor: pointer;\n}\n\n.history-accordion-icon {\n  transition: transform 0.2s ease;\n  opacity: 0.6;\n}\n\n.history-accordion-icon.expanded {\n  transform: rotate(0deg);\n}\n\n.history-accordion-icon.collapsed {\n  transform: rotate(-90deg);\n}\n\n/* History Items */\n.history-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0.5rem 0.75rem;\n  background-color: transparent;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  position: relative;\n  border-radius: 0.25rem;\n}\n\n.history-item:hover {\n  background-color: var(--hover-color);\n}\n\n.history-item.active {\n  background-color: rgba(33, 150, 243, 0.05);\n}\n\n.history-item-content {\n  display: flex;\n  align-items: center;\n  gap: 0.375rem;\n  flex: 1;\n  min-width: 0;\n}\n\n.history-item-title {\n  font-size: 0.75rem;\n  color: var(--text-color);\n  font-weight: 400;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  opacity: 0.8;\n}\n\n.history-item-actions {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.history-action-button {\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.25rem;\n  border-radius: 0.25rem;\n  color: var(--text-color);\n  opacity: 0.6;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.history-action-button:hover {\n  opacity: 1;\n  background-color: var(--border-color);\n}\n\n/* Conversation Menu */\n.conversation-menu {\n  position: absolute;\n  /* top: calc(100% + 4px); */\n  right: 0;\n  background-color: var(--paper-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  box-shadow: var(--shadow-xl);\n  min-width: 200px;\n  max-width: 250px;\n  z-index: 99999;\n  overflow: hidden;\n}\n\n.conversation-menu-item {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  width: 100%;\n  padding: 0.75rem;\n  background: none;\n  border: none;\n  color: var(--text-color);\n  cursor: pointer;\n  transition: background-color 0.2s ease;\n  font-size: 0.875rem;\n  text-align: left;\n}\n\n.conversation-menu-item:hover:not(.datetime) {\n  background-color: var(--hover-color);\n}\n\n.conversation-menu-item.datetime {\n  background-color: rgba(0, 0, 0, 0.02);\n  cursor: default;\n  font-size: 0.75rem;\n  opacity: 0.8;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.conversation-menu-item.danger {\n  color: var(--button-danger-bg);\n}\n\n.conversation-menu-item.danger:hover {\n  background-color: rgba(244, 67, 54, 0.1);\n}\n\n/* See More Button */\n.see-more-button {\n  padding: 0.75rem;\n  background: none;\n  border: 1px dashed var(--border-color);\n  border-radius: 0.375rem;\n  color: var(--text-color);\n  cursor: pointer;\n  font-size: 0.875rem;\n  transition: all 0.2s ease;\n  opacity: 0.7;\n}\n\n.see-more-button:hover:not(:disabled) {\n  opacity: 1;\n  background-color: var(--hover-color);\n  border-style: solid;\n}\n\n.see-more-button:disabled {\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n",""]);const i=s},3915:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"/* Markdown and Code Styles for BrainDriveChat */\n\n/* Markdown Styles */\n.markdown-link {\n  color: var(--button-primary-bg);\n  text-decoration: underline;\n  transition: color 0.2s ease;\n}\n\n.markdown-link:hover {\n  color: #1976d2;\n  text-decoration: none;\n}\n\n.markdown-inline-code {\n  background-color: rgba(0, 0, 0, 0.08);\n  padding: 0.125rem 0.375rem;\n  border-radius: 0.25rem;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 0.875em;\n  color: #d63384;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  white-space: nowrap;\n  display: inline-block;\n  line-height: 1.2;\n}\n\n.markdown-code-block {\n  background-color: rgba(0, 0, 0, 0.05);\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  padding: 1rem;\n  margin: 0.5rem 0;\n  overflow-x: auto;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 0.875rem;\n  line-height: 1.5;\n}\n\n.markdown-code-block code {\n  background: none;\n  padding: 0;\n  border-radius: 0;\n  color: inherit;\n}\n\n.markdown-blockquote {\n  border-left: 4px solid var(--button-primary-bg);\n  margin: 0.5rem 0;\n  padding: 0.5rem 1rem;\n  background-color: rgba(33, 150, 243, 0.05);\n  border-radius: 0.25rem;\n  font-style: italic;\n}\n\n/* Minimal blockquote spacing */\n.message-content blockquote {\n  margin: 0.125rem 0 !important;\n  padding: 0.125rem 0.5rem !important;\n}\n\n.markdown-table-wrapper {\n  overflow-x: auto;\n  margin: 0.5rem 0;\n  border-radius: 0.375rem;\n  border: 1px solid var(--border-color);\n}\n\n.markdown-table {\n  width: 100%;\n  border-collapse: collapse;\n  font-size: 0.875rem;\n}\n\n.markdown-table-header {\n  background-color: rgba(0, 0, 0, 0.05);\n  padding: 0.5rem;\n  text-align: left;\n  font-weight: 600;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.markdown-table-cell {\n  padding: 0.5rem;\n  border-bottom: 1px solid var(--border-color);\n  vertical-align: top;\n}\n\n.markdown-table tr:last-child .markdown-table-cell {\n  border-bottom: none;\n}\n\n/* Minimal table spacing */\n.message-content table {\n  margin: 0.125rem 0 !important;\n}\n\n.message-content th,\n.message-content td {\n  padding: 0.125rem 0.25rem !important;\n}\n\n/* Enhanced Code Block Styles */\n.enhanced-code-block {\n  border: 1px solid var(--border-color);\n  border-radius: 0.5rem;\n  margin: 0.75rem 0;\n  overflow: hidden;\n  background-color: var(--paper-bg);\n  box-shadow: var(--shadow-sm);\n}\n\n.enhanced-code-block .code-block-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem 1rem !important;\n  background-color: rgba(0, 0, 0, 0.03);\n  border-bottom: 1px solid var(--border-color);\n  font-size: 0.875rem;\n  font-weight: 500;\n  min-height: 40px;\n}\n\n.code-block-info {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n\n.code-language {\n  color: var(--button-primary-bg);\n  font-weight: 600;\n  text-transform: uppercase;\n  font-size: 0.7rem;\n  letter-spacing: 0.05em;\n}\n\n.code-lines {\n  color: var(--text-color);\n  opacity: 0.7;\n}\n\n.code-block-actions {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n}\n\n.code-action-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 28px;\n  height: 28px;\n  border: none;\n  border-radius: 0.25rem;\n  background-color: transparent;\n  color: var(--text-color);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  opacity: 0.7;\n}\n\n.code-action-btn:hover {\n  opacity: 1;\n  background-color: var(--border-color);\n  transform: scale(1.05);\n}\n\n.code-action-btn.copied {\n  color: var(--status-success-color);\n  opacity: 1;\n}\n\n.code-block-content {\n  position: relative;\n}\n\n.code-block-content.collapsed {\n  max-height: 300px;\n  overflow: hidden;\n}\n\n/* Syntax highlighter overrides */\n.code-block-content .react-syntax-highlighter {\n  margin: 0 !important;\n  border-radius: 0 !important;\n}\n\n.code-block-content .react-syntax-highlighter pre {\n  margin: 0 !important;\n  padding: 1rem !important;\n  background-color: transparent !important;\n  border-radius: 0 !important;\n}\n\n.code-block-content .react-syntax-highlighter code {\n  background: none !important;\n  padding: 0 !important;\n  border-radius: 0 !important;\n  font-family: inherit !important;\n  font-size: inherit !important;\n}\n\n.code-collapse-indicator {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  padding: 0.75rem 1rem;\n  background: var(--paper-bg);\n  text-align: center;\n  font-size: 0.875rem;\n  color: var(--text-color);\n  font-weight: 500;\n  border: none;\n  border-top: 1px solid var(--border-color);\n  cursor: pointer;\n  transition: background-color 0.2s ease;\n  font-family: inherit;\n  width: 100%;\n}\n\n.code-collapse-indicator:hover,\n.code-collapse-indicator:focus {\n  background-color: var(--hover-color);\n  outline: none;\n}\n\n.code-collapse-indicator:focus {\n  box-shadow: 0 0 0 2px var(--button-primary-bg);\n}\n\n/* Raw Markdown Content Styles */\n.raw-markdown-content {\n  background-color: rgba(0, 0, 0, 0.02);\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  padding: 1rem;\n  margin: 0.5rem 0;\n  overflow-x: auto;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  white-space: pre-wrap;\n  word-break: break-word;\n  color: var(--text-color);\n}\n\n.raw-markdown-content code {\n  background: none;\n  padding: 0;\n  border-radius: 0;\n  color: inherit;\n  font-family: inherit;\n  font-size: inherit;\n}\n\n/* Markdown emphasis styles */\n.message-content strong {\n  font-weight: 600;\n}\n\n.message-content em {\n  font-style: italic;\n}\n\n/* Markdown horizontal rule */\n.message-content hr {\n  border: none;\n  border-top: 1px solid var(--border-color);\n  margin: 0.25rem 0 !important;\n}\n\n/* Global reset for react-markdown to prevent default spacing */\n.message-content * {\n  box-sizing: border-box;\n}\n\n/* Override any default browser margins/padding */\n.message-content div,\n.message-content span,\n.message-content p,\n.message-content h1,\n.message-content h2,\n.message-content h3,\n.message-content h4,\n.message-content h5,\n.message-content h6 {\n  margin: 0 !important;\n  padding: 0 !important;\n}\n\n/* Preserve proper list formatting */\n.message-content ul,\n.message-content ol {\n  margin: 0.25rem 0 !important;\n  padding: 0 !important;\n  padding-left: 1.5rem !important;\n}\n\n.message-content li {\n  margin: 0.125rem 0 !important;\n  padding: 0 !important;\n  line-height: 1.4 !important;\n}\n\n/* Nested list indentation */\n.message-content ul ul,\n.message-content ol ol,\n.message-content ul ol,\n.message-content ol ul {\n  margin: 0.125rem 0 !important;\n  padding-left: 1.25rem !important;\n}\n\n/* Preserve code block header spacing */\n.message-content .enhanced-code-block * {\n  box-sizing: border-box;\n}\n\n/* Override any react-markdown specific styling */\n.message-content .react-markdown,\n.message-content [data-rmiz-content] {\n  margin: 0 !important;\n  padding: 0 !important;\n  line-height: 1.3 !important;\n}\n\n/* Ensure no extra spacing from remark-gfm */\n.message-content .gfm-content {\n  margin: 0 !important;\n  padding: 0 !important;\n}\n",""]);const i=s},4103:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"/* Base variables for light theme */\n:root {\n  --bg-color: #ffffff;\n  --paper-bg: #ffffff;\n  --text-color: #333333;\n  --border-color: rgba(0, 0, 0, 0.2);\n  --hover-color: rgba(0, 0, 0, 0.1);\n  --input-bg: #ffffff;\n  --button-primary-bg: #2196f3;\n  --button-primary-text: #ffffff;\n  --button-secondary-bg: #e0e0e0;\n  --button-secondary-text: #333333;\n  --button-danger-bg: #f44336;\n  --button-danger-text: #ffffff;\n  --status-success-color: #4caf50;\n  --status-error-color: #f44336;\n  --status-checking-color: #ff9800;\n  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);\n}\n\n/* Reset and base styles */\n* {\n  box-sizing: border-box;\n}\n\n/* Layout utilities */\n.flex { display: flex; }\n.flex-col { flex-direction: column; }\n.flex-row { flex-direction: row; }\n.flex-1 { flex: 1; }\n.flex-none { flex: none; }\n.items-center { align-items: center; }\n.items-start { align-items: flex-start; }\n.items-end { align-items: flex-end; }\n.justify-center { justify-content: center; }\n.justify-between { justify-content: space-between; }\n.justify-start { justify-content: flex-start; }\n.justify-end { justify-content: flex-end; }\n\n/* Spacing utilities */\n.gap-1 { gap: 0.25rem; }\n.gap-2 { gap: 0.5rem; }\n.gap-3 { gap: 0.75rem; }\n.gap-4 { gap: 1rem; }\n.gap-6 { gap: 1.5rem; }\n.gap-8 { gap: 2rem; }\n\n.p-0 { padding: 0; }\n.p-1 { padding: 0.25rem; }\n.p-2 { padding: 0.5rem; }\n.p-3 { padding: 0.75rem; }\n.p-4 { padding: 1rem; }\n.p-6 { padding: 1.5rem; }\n.p-8 { padding: 2rem; }\n\n.px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }\n.px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }\n.px-4 { padding-left: 1rem; padding-right: 1rem; }\n.px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }\n\n.py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }\n.py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }\n.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }\n.py-4 { padding-top: 1rem; padding-bottom: 1rem; }\n\n.m-0 { margin: 0; }\n.m-1 { margin: 0.25rem; }\n.m-2 { margin: 0.5rem; }\n.m-3 { margin: 0.75rem; }\n.m-4 { margin: 1rem; }\n\n.mx-auto { margin-left: auto; margin-right: auto; }\n.my-2 { margin-top: 0.5rem; margin-bottom: 0.5rem; }\n.my-4 { margin-top: 1rem; margin-bottom: 1rem; }\n\n.mt-1 { margin-top: 0.25rem; }\n.mt-2 { margin-top: 0.5rem; }\n.mt-4 { margin-top: 1rem; }\n.mb-2 { margin-bottom: 0.5rem; }\n.mb-4 { margin-bottom: 1rem; }\n.ml-2 { margin-left: 0.5rem; }\n.mr-2 { margin-right: 0.5rem; }\n\n/* Width and height utilities */\n.w-full { width: 100%; }\n.w-auto { width: auto; }\n.w-fit { width: fit-content; }\n.h-full { height: 100%; }\n.h-auto { height: auto; }\n.h-fit { height: fit-content; }\n.min-h-0 { min-height: 0; }\n.max-w-xs { max-width: 20rem; }\n.max-w-sm { max-width: 24rem; }\n.max-w-md { max-width: 28rem; }\n.max-w-lg { max-width: 32rem; }\n.max-w-xl { max-width: 36rem; }\n\n/* Position utilities */\n.relative { position: relative; }\n.absolute { position: absolute; }\n.fixed { position: fixed; }\n.top-0 { top: 0; }\n.right-0 { right: 0; }\n.bottom-0 { bottom: 0; }\n.left-0 { left: 0; }\n\n/* Border utilities */\n.border { border: 1px solid var(--border-color); }\n.border-t { border-top: 1px solid var(--border-color); }\n.border-b { border-bottom: 1px solid var(--border-color); }\n.border-l { border-left: 1px solid var(--border-color); }\n.border-r { border-right: 1px solid var(--border-color); }\n.border-none { border: none; }\n\n.rounded { border-radius: 0.25rem; }\n.rounded-md { border-radius: 0.375rem; }\n.rounded-lg { border-radius: 0.5rem; }\n.rounded-xl { border-radius: 0.75rem; }\n.rounded-2xl { border-radius: 1rem; }\n.rounded-full { border-radius: 9999px; }\n\n/* Background utilities */\n.bg-transparent { background-color: transparent; }\n.bg-white { background-color: #ffffff; }\n.bg-gray-50 { background-color: #f9fafb; }\n.bg-gray-100 { background-color: #f3f4f6; }\n.bg-gray-200 { background-color: #e5e7eb; }\n.bg-blue-500 { background-color: #3b82f6; }\n.bg-blue-600 { background-color: #2563eb; }\n.bg-red-500 { background-color: #ef4444; }\n.bg-green-500 { background-color: #10b981; }\n\n/* Text utilities */\n.text-xs { font-size: 0.75rem; line-height: 1rem; }\n.text-sm { font-size: 0.875rem; line-height: 1.25rem; }\n.text-base { font-size: 1rem; line-height: 1.5rem; }\n.text-lg { font-size: 1.125rem; line-height: 1.75rem; }\n.text-xl { font-size: 1.25rem; line-height: 1.75rem; }\n\n.font-normal { font-weight: 400; }\n.font-medium { font-weight: 500; }\n.font-semibold { font-weight: 600; }\n.font-bold { font-weight: 700; }\n\n.text-left { text-align: left; }\n.text-center { text-align: center; }\n.text-right { text-align: right; }\n\n.text-white { color: #ffffff; }\n.text-gray-500 { color: #6b7280; }\n.text-gray-600 { color: #4b5563; }\n.text-gray-700 { color: #374151; }\n.text-gray-900 { color: #111827; }\n\n/* Shadow utilities */\n.shadow-sm { box-shadow: var(--shadow-sm); }\n.shadow { box-shadow: var(--shadow-md); }\n.shadow-md { box-shadow: var(--shadow-md); }\n.shadow-lg { box-shadow: var(--shadow-lg); }\n.shadow-xl { box-shadow: var(--shadow-xl); }\n\n/* Overflow utilities */\n.overflow-hidden { overflow: hidden; }\n.overflow-auto { overflow: auto; }\n.overflow-y-auto { overflow-y: auto; }\n.overflow-x-hidden { overflow-x: hidden; }\n\n/* Cursor utilities */\n.cursor-pointer { cursor: pointer; }\n.cursor-not-allowed { cursor: not-allowed; }\n\n/* Opacity utilities */\n.opacity-50 { opacity: 0.5; }\n.opacity-70 { opacity: 0.7; }\n.opacity-90 { opacity: 0.9; }\n\n/* Transition utilities */\n.transition { transition: all 0.15s ease-in-out; }\n.transition-colors { transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out; }\n.transition-transform { transition: transform 0.15s ease-in-out; }\n\n/* Transform utilities */\n.scale-105 { transform: scale(1.05); }\n.scale-110 { transform: scale(1.1); }\n\n/* Hover utilities */\n.hover\\:opacity-90:hover { opacity: 0.9; }\n.hover\\:scale-105:hover { transform: scale(1.05); }\n.hover\\:bg-blue-600:hover { background-color: #2563eb; }\n\n/* Focus utilities */\n.focus\\:outline-none:focus { outline: none; }\n.focus\\:ring-2:focus { box-shadow: 0 0 0 2px var(--button-primary-bg); }\n\n/* Disabled utilities */\n.disabled\\:opacity-50:disabled { opacity: 0.5; }\n.disabled\\:cursor-not-allowed:disabled { cursor: not-allowed; }\n",""]);const i=s},4638:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"/* Main container */\n.braindrive-chat-container {\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n  color: var(--text-color);\n  background-color: var(--bg-color);\n  transition: background-color 0.3s ease, color 0.3s ease;\n  display: flex;\n  flex-direction: column;\n  height: 100%; /* Use full height of the container */\n  max-height: 100%; /* Prevent the container from growing beyond its allocated space */\n  width: 100%;\n  overflow: hidden; /* Prevent any overflow on the main container */\n  position: relative;\n}\n\n/* Chat-specific components */\n.chat-paper {\n  background-color: var(--paper-bg);\n  border-radius: 0.5rem;\n  box-shadow: var(--shadow-lg);\n  overflow: hidden;\n  transition: background-color 0.3s ease, box-shadow 0.3s ease;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  max-height: 100%; /* Prevent overflow */\n  min-height: 0; /* Allow flex items to shrink below their content size */\n  position: relative;\n}\n\n.chat-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem 1rem;\n  border-bottom: 1px solid var(--border-color);\n  background-color: var(--paper-bg);\n  flex-shrink: 0;\n}\n\n.chat-controls {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n}\n\n.chat-history-container {\n  position: relative;\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  max-height: 100%;\n  overflow: hidden;\n}\n\n.chat-history {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 1rem 1rem 6rem;\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  scrollbar-width: thin;\n  scrollbar-color: var(--border-color) transparent;\n  min-height: 0; /* Allow the flex item to shrink below its content size */\n  max-height: 100%; /* Prevent the chat history from expanding beyond available space */\n  /* Use flex: 1 to take available space between header and input */\n  height: 0; /* This forces the flex item to respect the container height */\n}\n\n.chat-history::-webkit-scrollbar {\n  width: 6px;\n}\n\n.chat-history::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.chat-history::-webkit-scrollbar-thumb {\n  background-color: var(--border-color);\n  border-radius: 3px;\n}\n\n.chat-input-container {\n  display: flex;\n  padding: 1rem;\n  background-color: var(--paper-bg);\n  flex-shrink: 0;\n  border: none; /* Ensure no border on container */\n}\n\n/* Chat input wrapper */\n.chat-input-wrapper {\n  position: relative;\n  flex: 1;\n  max-width: 100%;\n  display: flex;\n  align-items: stretch;\n  border: none; /* Ensure no border on wrapper */\n}\n\n/* Input container with buttons */\n.input-with-buttons {\n  position: relative;\n  flex: 1;\n  border: 1px solid var(--border-color);\n  border-radius: 0.5rem;\n  background-color: var(--input-bg);\n  transition: border-color 0.3s ease;\n  padding: 0.25rem 0.5rem; /* breathing room for flex row */\n}\n\n.input-with-buttons:focus-within {\n  border-color: var(--button-primary-bg);\n}\n\n.chat-input-row {\n  display: flex;\n  align-items: center; /* center when single line */\n  gap: 0.5rem;\n}\n\n.chat-input-row.multiline {\n  align-items: flex-end; /* snap to bottom when multiline */\n}\n\n.chat-input {\n  width: 100%;\n  padding: 0.5rem 0.75rem;\n  border: none !important; /* Force no border on textarea */\n  border-radius: 0.5rem;\n  background-color: transparent;\n  color: var(--text-color);\n  resize: none;\n  min-height: calc(1.5em + 0.5rem); /* ~1 line */\n  max-height: calc(1.5em * 4 + 0.5rem); /* ~4 lines */\n  overflow-y: auto;\n  scrollbar-width: thin;\n  scrollbar-color: var(--border-color) transparent;\n  font-family: inherit;\n  font-size: inherit;\n  line-height: 1.5;\n  box-shadow: none !important; /* Remove any default box-shadow */\n  outline: none; /* Remove any default outline */\n}\n\n.chat-input:focus {\n  outline: none;\n}\n\n/* Overlay button row removed in favor of inline flex layout */\n\n/* Resize Handle */\n.resize-handle {\n  height: 8px;\n  background-color: transparent;\n  cursor: row-resize;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n  position: relative;\n  transition: background-color 0.2s ease;\n}\n\n.resize-handle:hover {\n  background-color: var(--border-color);\n}\n\n.resize-handle-line {\n  width: 40px;\n  height: 2px;\n  background-color: var(--border-color);\n  border-radius: 1px;\n  transition: all 0.2s ease;\n}\n\n.resize-handle:hover .resize-handle-line {\n  width: 60px;\n  background-color: var(--button-primary-bg);\n}\n\n/* History Section - Below Chat */\n.history-section {\n  border-top: 1px solid var(--border-color);\n  background-color: var(--paper-bg);\n  padding: 1rem;\n  flex-shrink: 0;\n  transition: padding 0.3s ease;\n}\n\n.history-section.collapsed {\n  padding: 0.5rem 1rem;\n}\n\n.history-header {\n  margin-bottom: 0.75rem;\n}\n\n.history-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n  max-height: calc(40vh - 60px); /* Dynamic height based on viewport */\n  overflow-y: auto;\n  scrollbar-width: thin;\n  scrollbar-color: var(--border-color) transparent;\n  padding-right: 8px; /* Add padding for scrollbar */\n  margin-bottom: 8px; /* Add margin to ensure last items are visible */\n}\n\n.history-list::-webkit-scrollbar {\n  width: 4px;\n}\n\n.history-list::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.history-list::-webkit-scrollbar-thumb {\n  background-color: var(--border-color);\n  border-radius: 2px;\n}\n",""]);const i=s},4658:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"/* Responsive Design for BrainDriveChat */\n\n/* Large screens */\n@media (min-width: 1400px) {\n  .chat-header-redesigned {\n    gap: 2rem;\n  }\n  \n  .header-model-section .header-select {\n    min-width: 180px;\n    max-width: 200px;\n  }\n  \n  .header-persona-section .header-select {\n    min-width: 160px;\n    max-width: 180px;\n  }\n}\n\n/* Medium screens */\n@media (max-width: 1200px) {\n  .chat-header-redesigned {\n    grid-template-columns: auto auto 1fr auto;\n    gap: 1rem;\n  }\n  \n  .header-model-section .header-select {\n    max-width: 150px;\n  }\n  \n  .header-persona-section .header-select {\n    max-width: 140px;\n  }\n}\n\n/* Tablets and small laptops */\n@media (max-width: 768px) {\n  .chat-header-redesigned {\n    grid-template-columns: 1fr;\n    gap: 1rem;\n    padding: 0.75rem 1rem;\n    min-height: auto;\n  }\n\n  .header-model-section {\n    justify-self: stretch;\n    order: 1;\n  }\n\n  .header-model-section .header-select {\n    max-width: none;\n    flex: 1;\n  }\n\n  .header-persona-section {\n    justify-self: stretch;\n    order: 2;\n  }\n\n  .header-persona-section .header-select {\n    max-width: none;\n    flex: 1;\n  }\n\n  .header-history-section {\n    justify-self: stretch;\n    max-width: none;\n    order: 3;\n  }\n\n  .header-actions-section {\n    justify-self: center;\n    order: 4;\n    gap: 0.75rem;\n  }\n\n  .header-new-chat-button {\n    width: 40px;\n    height: 40px;\n    padding: 0.5rem;\n  }\n\n  .header-icon-only {\n    width: 40px;\n    height: 40px;\n  }\n\n  .modal-overlay {\n    padding: 0.5rem;\n  }\n\n  .modal-content {\n    max-width: none;\n  }\n\n  .header-select {\n    font-size: 0.875rem;\n    padding: 0.5rem 0.75rem;\n  }\n\n  .history-accordion-button {\n    padding: 0.75rem 0;\n  }\n\n  .history-accordion-icon {\n    opacity: 0.8;\n  }\n\n  .message {\n    max-width: 90%;\n  }\n  \n  .chat-input-container {\n    padding: 0.75rem;\n  }\n  \n  .chat-input {\n    padding: 0.625rem;\n  }\n  \n  .chat-header {\n    padding: 0.5rem 0.75rem;\n  }\n  \n  .chat-controls {\n    gap: 0.5rem;\n  }\n\n  .search-results-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.75rem;\n  }\n  \n  .search-toggle-btn {\n    align-self: flex-end;\n  }\n  \n  .search-results-summary {\n    flex-wrap: wrap;\n  }\n  \n  .message-search-results {\n    max-width: 95%;\n  }\n\n  .document-context-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.75rem;\n  }\n  \n  .document-toggle-btn {\n    align-self: flex-end;\n  }\n  \n  .document-context-summary {\n    flex-wrap: wrap;\n  }\n  \n  .message-document-context {\n    max-width: 95%;\n  }\n\n  .message-actions {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 0.25rem;\n  }\n  \n  .ai-message-actions {\n    align-self: flex-end;\n  }\n  \n  .message-action-btn {\n    min-width: 28px;\n    height: 28px;\n    font-size: 1rem;\n  }\n  \n  .markdown-table-wrapper {\n    font-size: 0.75rem;\n  }\n  \n  .markdown-code-block {\n    font-size: 0.75rem;\n    padding: 0.75rem;\n  }\n}\n\n/* Mobile devices */\n@media (max-width: 480px) {\n  .header-actions-section {\n    gap: 0.5rem;\n  }\n  \n  .header-icon-only {\n    width: 36px;\n    height: 36px;\n  }\n\n  .header-new-chat-button {\n    width: 36px;\n    height: 36px;\n    padding: 0.375rem;\n  }\n\n  .history-accordion-button {\n    padding: 0.5rem 0;\n  }\n\n  .message-bubble {\n    max-width: 96%;\n  }\n  \n  .chat-history {\n    padding: 0.75rem 0.75rem 5rem;\n    gap: 0.75rem;\n  }\n  \n  .chat-input-container {\n    padding: 0.5rem;\n  }\n  \n  .chat-header {\n    padding: 0.5rem;\n  }\n\n  .search-results-summary {\n    font-size: 0.875rem;\n  }\n  \n  .search-toggle-btn {\n    padding: 0.25rem 0.5rem;\n    font-size: 0.75rem;\n  }\n  \n  .search-result-item {\n    padding: 0.5rem;\n  }\n\n  .document-context-summary {\n    font-size: 0.875rem;\n  }\n  \n  .document-toggle-btn {\n    padding: 0.25rem 0.5rem;\n    font-size: 0.75rem;\n  }\n  \n  .document-content {\n    font-size: 0.75rem;\n    max-height: 200px;\n  }\n\n  .message-edit-actions {\n    flex-direction: column;\n    gap: 0.25rem;\n  }\n  \n  .message-edit-actions .btn {\n    width: 100%;\n  }\n  \n  .markdown-table-wrapper {\n    font-size: 0.7rem;\n  }\n  \n  .markdown-code-block {\n    font-size: 0.7rem;\n    padding: 0.5rem;\n  }\n}\n",""]);const i=s},6250:(e,n,t)=>{t.r(n),t.d(n,{default:()=>je,version:()=>Me});var r=t(4848),o=t(2769),a=t.n(o),s=t(5072),i=t.n(s),c=t(7825),l=t.n(c),d=t(7659),u=t.n(d),p=t(5056),h=t.n(p),g=t(540),m=t.n(g),f=t(1113),b=t.n(f),v=t(7492),y={};function x(e){return void 0===e&&(e="id"),"".concat(e,"_").concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}function w(e){if(!e)return"";if("string"==typeof e)return e;if("object"==typeof e){if(e.text&&"string"==typeof e.text)return e.text;if(e.choices&&Array.isArray(e.choices)&&e.choices.length>0){var n=e.choices[0];if(n.delta&&n.delta.content)return n.delta.content;if(n.message&&n.message.content)return n.message.content;if(n.text)return n.text}for(var t=0,r=["content","message","response","output","result","answer"];t<r.length;t++){var o=r[t];if(e[o]&&"string"==typeof e[o])return e[o]}if(e.delta&&e.delta.content)return e.delta.content;if(e.message&&e.message.content)return e.message.content}return""}function S(e){try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch(e){return""}}function k(e){try{var n=new Date(e),t=(new Date).getTime()-n.getTime(),r=Math.floor(t/6e4),o=Math.floor(r/60),a=Math.floor(o/24);return r<1?"Just now":r<60?"".concat(r," min").concat(1!==r?"s":""," ago"):o<24?"".concat(o," hour").concat(1!==o?"s":""," ago"):a<7?"".concat(a," day").concat(1!==a?"s":""," ago"):n.toLocaleDateString()}catch(e){return""}}y.styleTagTransform=b(),y.setAttributes=h(),y.insert=u().bind(null,"head"),y.domAPI=l(),y.insertStyleElement=m(),i()(v.A,y),v.A&&v.A.locals&&v.A.locals;var C,j={ollama:"ollama_servers_settings",openai:"openai_api_keys_settings",openrouter:"openrouter_api_keys_settings",claude:"claude_api_keys_settings",groq:"groq_api_keys_settings"},M=function(){return(0,r.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"stroke-[2]",children:[(0,r.jsx)("path",{d:"M10 4V4C8.13623 4 7.20435 4 6.46927 4.30448C5.48915 4.71046 4.71046 5.48915 4.30448 6.46927C4 7.20435 4 8.13623 4 10V13.6C4 15.8402 4 16.9603 4.43597 17.816C4.81947 18.5686 5.43139 19.1805 6.18404 19.564C7.03968 20 8.15979 20 10.4 20H14C15.8638 20 16.7956 20 17.5307 19.6955C18.5108 19.2895 19.2895 18.5108 19.6955 17.5307C20 16.7956 20 15.8638 20 14V14",stroke:"currentColor",strokeLinecap:"square"}),(0,r.jsx)("path",{d:"M12.4393 14.5607L19.5 7.5C20.3284 6.67157 20.3284 5.32843 19.5 4.5C18.6716 3.67157 17.3284 3.67157 16.5 4.5L9.43934 11.5607C9.15804 11.842 9 12.2235 9 12.6213V15H11.3787C11.7765 15 12.158 14.842 12.4393 14.5607Z",stroke:"currentColor",strokeLinecap:"square"})]})},P=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})})},_=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})},N=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})},I=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"})})},E=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M8 5v14l11-7z"})})},T=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})})},O=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"})})},A=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"})})},D=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M6 6h12v12H6z"})})},z=function(){return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"})})},L=function(e){var n=e.isActive;return(0,r.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:n?"text-blue-500":"",children:(0,r.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})})},R=(C=function(e,n){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},C(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=e}C(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),H=function(e){function n(n){var t=e.call(this,n)||this;return t.buttonRef=a().createRef(),t.inputRef=a().createRef(),t.listRef=a().createRef(),t.handleDocumentClick=function(e){if(t.state.isOpen){var n=e.target,r=t.buttonRef.current,o=t.listRef.current;r&&r.contains(n)||o&&o.contains(n)||t.closeMenu()}},t.openMenu=function(){t.props.disabled||t.props.loading||t.state.isOpen||t.setState({isOpen:!0})},t.closeMenu=function(){(t.state.isOpen||""!==t.state.query)&&t.setState({isOpen:!1,query:"",activeIndex:-1},(function(){var e=t.buttonRef.current;e&&e.focus({preventScroll:!0})}))},t.toggleMenu=function(){t.state.isOpen?t.closeMenu():t.openMenu()},t.handleSelect=function(e){e.disabled||(t.props.onSelect(e.value),t.closeMenu())},t.handleButtonKeyDown=function(e){if(!t.props.disabled&&!t.props.loading)return"ArrowDown"===e.key||"ArrowUp"===e.key?(e.preventDefault(),void(t.state.isOpen||t.openMenu())):"Enter"===e.key||" "===e.key?(e.preventDefault(),void t.toggleMenu()):void(1!==e.key.length||e.altKey||e.ctrlKey||e.metaKey||(e.preventDefault(),t.setState((function(n){return{isOpen:!0,query:"".concat(n.isOpen?n.query:"").concat(e.key)}}))))},t.handleInputChange=function(e){t.setState({query:e.target.value})},t.handleInputKeyDown=function(e){if(t.state.isOpen){var n=t.getFilteredOptions(),r=n.length;if("ArrowDown"!==e.key)if("ArrowUp"!==e.key)if("Enter"!==e.key)"Escape"===e.key&&(e.preventDefault(),t.closeMenu());else{e.preventDefault();var o=t.state.activeIndex;o>=0&&o<r&&t.handleSelect(n[o])}else{if(e.preventDefault(),0===r)return;t.setState((function(e){var n=e.activeIndex-1;return{activeIndex:n<0?r-1:n}}))}else{if(e.preventDefault(),0===r)return;t.setState((function(e){var n=e.activeIndex+1;return{activeIndex:n>=r?0:n}}))}}},t.handleOptionMouseEnter=function(e){e!==t.state.activeIndex&&t.setState({activeIndex:e})},t.handleOptionMouseDown=function(e,n){e.preventDefault(),t.handleSelect(n)},t.state={isOpen:!1,query:"",activeIndex:-1},t}return R(n,e),n.prototype.componentDidMount=function(){document.addEventListener("mousedown",this.handleDocumentClick)},n.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.handleDocumentClick)},n.prototype.componentDidUpdate=function(e,n){!n.isOpen&&this.state.isOpen&&this.focusInput(),n.isOpen===this.state.isOpen&&n.query===this.state.query&&e.options===this.props.options&&e.value===this.props.value||this.syncActiveIndex()},n.prototype.focusInput=function(){var e=this.inputRef.current;e&&(e.focus({preventScroll:!0}),e.select())},n.prototype.getFilteredOptions=function(){var e=this.props.options,n=this.state.query.trim().toLowerCase();return n?e.filter((function(e){return function(e,n,t){if(t||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))}([e.label,e.description],e.keywords||[],!0).filter(Boolean).join(" ").toLowerCase().includes(n)})):e},n.prototype.syncActiveIndex=function(){var e=this;if(this.state.isOpen){var n=this.getFilteredOptions();if(0!==n.length){var t=n.findIndex((function(n){return n.value===e.props.value})),r=t>=0?t:this.state.activeIndex;(r<0||r>=n.length)&&(r=0),r!==this.state.activeIndex&&this.setState({activeIndex:r})}else-1!==this.state.activeIndex&&this.setState({activeIndex:-1})}else-1!==this.state.activeIndex&&this.setState({activeIndex:-1})},n.prototype.render=function(){var e=this,n=this.props,t=n.id,o=n.value,a=n.placeholder,s=n.searchPlaceholder,i=n.noResultsText,c=n.disabled,l=n.loading,d=n.className,u=n.triggerClassName,p=n.menuClassName,h=n.inputClassName,g=n.renderOption,m=n.renderValue,f=this.state,b=f.isOpen,v=f.activeIndex,y=f.query,x=this.getFilteredOptions(),w=this.props.options.find((function(e){return e.value===o}))||null,S="".concat(t,"-listbox"),k=b&&v>=0?"".concat(t,"-option-").concat(v):void 0;return(0,r.jsxs)("div",{className:"searchable-dropdown ".concat(d," ").concat(b?"open":""," ").concat(c||l?"disabled":"").trim(),role:"combobox","aria-haspopup":"listbox","aria-owns":S,"aria-expanded":b,"aria-controls":b?S:void 0,children:[(0,r.jsxs)("button",{ref:this.buttonRef,type:"button",className:"searchable-dropdown-trigger ".concat(u).trim(),"aria-haspopup":"listbox","aria-expanded":b,"aria-controls":b?S:void 0,"aria-disabled":c||l,onClick:this.toggleMenu,onKeyDown:this.handleButtonKeyDown,disabled:c||l,children:[(0,r.jsx)("span",{className:"searchable-dropdown-value",children:l?"Loading...":m?m(w):(null==w?void 0:w.label)||a}),(0,r.jsx)("span",{className:"searchable-dropdown-icon","aria-hidden":"true",children:""})]}),b&&(0,r.jsxs)("div",{ref:this.listRef,className:"searchable-dropdown-menu ".concat(p).trim(),children:[(0,r.jsx)("div",{className:"searchable-dropdown-search",children:(0,r.jsx)("input",{ref:this.inputRef,type:"text",className:"searchable-dropdown-input ".concat(h).trim(),placeholder:s,value:y,onChange:this.handleInputChange,onKeyDown:this.handleInputKeyDown,"aria-controls":S,"aria-activedescendant":k})}),(0,r.jsx)("div",{className:"searchable-dropdown-options",role:"listbox",id:S,children:0===x.length?(0,r.jsx)("div",{className:"searchable-dropdown-empty",role:"alert",children:i}):x.map((function(n,a){var s="".concat(t,"-option-").concat(a),i=n.value===o,c=a===v;return(0,r.jsx)("div",{id:s,role:"option","aria-selected":i,"aria-disabled":n.disabled,className:"searchable-dropdown-option ".concat(i?"selected":""," ").concat(c?"active":""," ").concat(n.disabled?"disabled":"").trim(),onMouseDown:function(t){return e.handleOptionMouseDown(t,n)},onMouseEnter:function(){return e.handleOptionMouseEnter(a)},children:g?g(n,{isActive:c,isSelected:i}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"searchable-dropdown-option-label",children:n.label}),n.description&&(0,r.jsx)("span",{className:"searchable-dropdown-option-description",children:n.description})]})},s)}))})]})]})},n.defaultProps={placeholder:"Select...",searchPlaceholder:"Type to search...",noResultsText:"No results found",disabled:!1,loading:!1,className:"",triggerClassName:"",menuClassName:"",inputClassName:""},n}(a().Component);const U=H;var B=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),F=function(e,n,t){if(t||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))};const K=function(e){function n(n){var t=e.call(this,n)||this;return t.menuButtonRef=null,t.menuRef=null,t.handleDocumentClick=function(e){var n,r,o=e.target;t.state.isMenuOpen&&o&&!(null===(n=t.menuRef)||void 0===n?void 0:n.contains(o))&&!(null===(r=t.menuButtonRef)||void 0===r?void 0:r.contains(o))&&t.setState({isMenuOpen:!1})},t.handleModelSelect=function(e){var n=t.props.onModelChange;n&&n(t.emitSelectEvent(e))},t.handlePersonaSelect=function(e){var n=t.props.onPersonaChange;n&&n(t.emitSelectEvent(e))},t.handleConversationSelect=function(e){var n=t.props,r=n.onConversationSelect,o=n.onNewChatClick;if(!e)return o(),void t.setState({isMenuOpen:!1});r(t.emitSelectEvent(e)),t.setState({isMenuOpen:!1})},t.state={isMenuOpen:!1},t}return B(n,e),n.prototype.componentDidMount=function(){document.addEventListener("mousedown",this.handleDocumentClick)},n.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.handleDocumentClick)},n.prototype.emitSelectEvent=function(e){return{target:{value:e},currentTarget:{value:e}}},n.prototype.render=function(){var e=this,n=this.props,t=n.models,o=n.selectedModel,a=n.isLoadingModels,s=(n.onModelChange,n.showModelSelection),i=n.personas,c=n.selectedPersona,l=(n.onPersonaChange,n.showPersonaSelection),d=n.conversations,u=n.selectedConversation,p=(n.onConversationSelect,n.onNewChatClick),h=n.showConversationHistory,g=n.isLoading,m=n.isLoadingHistory,f=t.map((function(e){return{value:"".concat(e.provider,"_").concat(e.serverId,"_").concat(e.name),label:"".concat(e.name," (").concat(e.serverName,")"),keywords:[e.provider,e.serverName,e.name]}})),b=F([{value:"",label:"No Persona"}],i.map((function(e){return{value:e.id,label:e.name,keywords:[e.description||"",e.name]}})),!0),v=F([{value:"",label:"Start New Chat"}],d.map((function(e){return{value:e.id,label:e.title||"Untitled",description:e.updated_at||e.created_at?k(e.updated_at||e.created_at):void 0,keywords:[e.title||"",e.id]}})),!0),y=o?"".concat(o.provider,"_").concat(o.serverId,"_").concat(o.name):"",x=(null==c?void 0:c.id)||"",w=(null==u?void 0:u.id)||"";return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"chat-header-redesigned",children:[s&&(0,r.jsxs)("div",{className:"header-model-section",children:[(0,r.jsx)("label",{className:"header-label",children:"Models"}),(0,r.jsx)(U,{id:"model-selection",value:y,options:f,onSelect:this.handleModelSelect,placeholder:0===t.length?"No models available":"Select model",searchPlaceholder:"Search models",noResultsText:"No models found",disabled:0===t.length,loading:a,triggerClassName:"header-select"})]}),l&&(0,r.jsxs)("div",{className:"header-persona-section",children:[(0,r.jsx)("label",{className:"header-label",children:"Persona"}),(0,r.jsx)(U,{id:"persona-selection",value:x,options:b,onSelect:this.handlePersonaSelect,placeholder:"No Persona",searchPlaceholder:"Search personas",noResultsText:"No personas found",disabled:this.props.isLoading||this.props.isLoadingHistory,triggerClassName:"header-select"})]}),h&&(0,r.jsxs)("div",{className:"header-history-section",children:[(0,r.jsx)("label",{className:"header-label",children:"History"}),(0,r.jsx)(U,{id:"conversation-selection",value:w,options:v,onSelect:this.handleConversationSelect,placeholder:"Start New Chat",searchPlaceholder:"Search conversations",noResultsText:"No conversations found",disabled:g||m,loading:m,triggerClassName:"header-select header-select-history",renderOption:function(e,n){var t=n.isSelected;return(0,r.jsxs)("div",{className:"searchable-dropdown-option-content",children:[(0,r.jsxs)("span",{className:"searchable-dropdown-option-label",children:[e.label,t?" (current)":""]}),e.description&&(0,r.jsx)("span",{className:"searchable-dropdown-option-description",children:e.description})]})},renderValue:function(e){return e?e.description?"".concat(e.label,"  ").concat(e.description):e.label:"Start New Chat"}}),(0,r.jsxs)("div",{className:"history-actions-wrapper",style:{position:"relative"},children:[(0,r.jsx)("button",{className:"header-icon-only",ref:function(n){return e.menuButtonRef=n},onClick:function(){return e.setState({isMenuOpen:!e.state.isMenuOpen})},title:"Conversation actions",disabled:!u||g||m,"aria-haspopup":"menu","aria-expanded":this.state.isMenuOpen,children:(0,r.jsx)(P,{})}),this.state.isMenuOpen&&u&&(0,r.jsxs)("div",{className:"conversation-menu",ref:function(n){return e.menuRef=n},role:"menu",style:{top:"calc(100% + 6px)"},children:[(0,r.jsx)("div",{className:"conversation-menu-item datetime",children:u.updated_at?"Updated ".concat(k(u.updated_at)):"Created ".concat(k(u.created_at))}),(0,r.jsxs)("button",{className:"conversation-menu-item",role:"menuitem",onClick:function(){var n,t;e.setState({isMenuOpen:!1}),null===(t=(n=e.props).onRenameSelectedConversation)||void 0===t||t.call(n,u.id)},children:[(0,r.jsx)(_,{}),(0,r.jsx)("span",{children:"Rename"})]}),(0,r.jsxs)("button",{className:"conversation-menu-item danger",role:"menuitem",onClick:function(){var n,t;e.setState({isMenuOpen:!1}),null===(t=(n=e.props).onDeleteSelectedConversation)||void 0===t||t.call(n,u.id)},children:[(0,r.jsx)(N,{}),(0,r.jsx)("span",{children:"Delete"})]})]})]})]}),(0,r.jsx)("div",{className:"header-actions-section",children:(0,r.jsx)("button",{className:"header-new-chat-button",onClick:p,disabled:g,title:"Start New Chat",children:(0,r.jsx)(M,{})})})]})})},n}(a().Component);var q=t(2391),G=t(8969),W=t(7622),V=t(1213),Y=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();const X=function(e){function n(n){var t=e.call(this,n)||this;t.copyToClipboard=function(){return e=t,n=void 0,o=function(){var e,n=this;return function(e,n){var t,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=i(0),s.throw=i(1),s.return=i(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,navigator.clipboard.writeText(this.props.children)];case 1:return t.sent(),this.setState({isCopied:!0}),setTimeout((function(){n.setState({isCopied:!1})}),2e3),[3,3];case 2:return e=t.sent(),console.error("Failed to copy code:",e),[3,3];case 3:return[2]}}))},new((r=void 0)||(r=Promise))((function(t,a){function s(e){try{c(o.next(e))}catch(e){a(e)}}function i(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,i)}c((o=o.apply(e,n||[])).next())}));var e,n,r,o},t.toggleCollapse=function(){console.log(" EnhancedCodeBlock toggleCollapse called, current state: ".concat(t.state.isCollapsed)),t.setState((function(e){var n=!e.isCollapsed;return console.log(" EnhancedCodeBlock setting isCollapsed to: ".concat(n)),{isCollapsed:n}}))};var r=n.children.split("\n");return t.contentHash=t.generateContentHash(n.children),t.state={isCollapsed:!1,isCopied:!1},console.log(" EnhancedCodeBlock created with hash: ".concat(t.contentHash.substring(0,8),", ").concat(r.length," lines, collapsible: ").concat(r.length>3)),t}return Y(n,e),n.prototype.componentDidMount=function(){console.log(" EnhancedCodeBlock mounted, isCollapsed: ".concat(this.state.isCollapsed))},n.prototype.componentDidUpdate=function(e,n){n.isCollapsed!==this.state.isCollapsed&&console.log(" EnhancedCodeBlock collapse state changed: ".concat(n.isCollapsed," -> ").concat(this.state.isCollapsed))},n.prototype.generateContentHash=function(e){for(var n=0,t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n&=n;return Math.abs(n).toString(16)},Object.defineProperty(n.prototype,"detectedLanguage",{get:function(){var e,n;return this.props.language||(null===(n=null===(e=this.props.className)||void 0===e?void 0:e.match(/language-(\w+)/))||void 0===n?void 0:n[1])||"text"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lines",{get:function(){return this.props.children.split("\n")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isCollapsible",{get:function(){return this.lines.length>3},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"displayLines",{get:function(){return this.state.isCollapsed?this.lines.slice(0,3):this.lines},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"displayContent",{get:function(){return this.displayLines.join("\n")},enumerable:!1,configurable:!0}),n.prototype.render=function(){this.props.className;var e=this.state,n=e.isCollapsed,t=e.isCopied;return(0,r.jsxs)("div",{className:"enhanced-code-block",children:[(0,r.jsxs)("div",{className:"code-block-header",children:[(0,r.jsxs)("div",{className:"code-block-info",children:[(0,r.jsx)("span",{className:"code-language",children:this.detectedLanguage}),(0,r.jsxs)("span",{className:"code-lines",children:[this.lines.length," line",1!==this.lines.length?"s":""]})]}),(0,r.jsxs)("div",{className:"code-block-actions",children:[this.isCollapsible&&(0,r.jsx)("button",{onClick:this.toggleCollapse,className:"code-action-btn",title:n?"Expand code":"Collapse code",children:(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:n?(0,r.jsx)("polyline",{points:"6,9 12,15 18,9"}):(0,r.jsx)("polyline",{points:"18,15 12,9 6,15"})})}),(0,r.jsx)("button",{onClick:this.copyToClipboard,className:"code-action-btn ".concat(t?"copied":""),title:t?"Copied!":"Copy code",children:(0,r.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t?(0,r.jsx)("polyline",{points:"20,6 9,17 4,12"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,r.jsx)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})})]})]}),(0,r.jsxs)("div",{className:"code-block-content ".concat(n?"collapsed":""),children:[(0,r.jsx)(W.A,{language:this.detectedLanguage,style:V.A,customStyle:{margin:0,borderRadius:0,fontSize:"0.875rem",lineHeight:1.5,fontFamily:"'Monaco', 'Menlo', 'Ubuntu Mono', monospace"},showLineNumbers:this.lines.length>1,wrapLines:!0,lineNumberStyle:{minWidth:"2.5em",paddingRight:"1em",textAlign:"right",userSelect:"none",color:"#6c757d"},children:this.displayContent}),n&&(0,r.jsx)("button",{className:"code-collapse-indicator",onClick:this.toggleCollapse,title:"Click to expand",children:(0,r.jsxs)("span",{children:["... ",this.lines.length-3," more lines"]})})]})]})},n}(a().Component);var J=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();const Q=function(e){function n(n){var t=e.call(this,n)||this;return t.ellipsisTimer=null,t.toggleExpanded=function(){t.setState((function(e){return{isExpanded:!e.isExpanded}}))},t.startEllipsisLoop=function(){null===t.ellipsisTimer&&(t.ellipsisTimer=window.setInterval((function(){t.setState((function(e){return{ellipsisStage:e.ellipsisStage>=0?(e.ellipsisStage+1)%3:0}}))}),500))},t.stopEllipsisLoop=function(e){null!==t.ellipsisTimer&&(window.clearInterval(t.ellipsisTimer),t.ellipsisTimer=null),e&&-1!==t.state.ellipsisStage&&t.setState({ellipsisStage:-1})},t.state={isExpanded:!1,ellipsisStage:-1},t}return J(n,e),n.prototype.componentDidMount=function(){this.props.isStreaming&&this.setState({ellipsisStage:0},this.startEllipsisLoop)},n.prototype.componentDidUpdate=function(e){!e.isStreaming&&this.props.isStreaming&&this.setState({isExpanded:!1,ellipsisStage:0},this.startEllipsisLoop),e.isStreaming&&!this.props.isStreaming&&this.stopEllipsisLoop(!0)},n.prototype.componentWillUnmount=function(){this.stopEllipsisLoop(!1)},n.prototype.render=function(){var e=this.props,n=e.children,t=e.isStreaming,o=this.state,a=o.isExpanded,s=o.ellipsisStage,i=n.replace(/<\/?think>/g,"").trim(),c=t&&s>=0?" ".concat(".".repeat(s+1)):"",l="Thinking Process".concat(c);return(0,r.jsxs)("div",{className:"thinking-block ".concat(a?"expanded":"collapsed"," ").concat(t?"thinking-streaming":""),children:[(0,r.jsxs)("button",{type:"button",className:"thinking-header",onClick:this.toggleExpanded,"aria-expanded":a,children:[(0,r.jsx)("span",{className:"thinking-title",children:l}),(0,r.jsx)("span",{className:"thinking-toggle","aria-hidden":"true",children:a?"":""})]}),(0,r.jsx)("div",{className:"thinking-panel","aria-hidden":!a,children:a&&(0,r.jsx)("div",{className:"thinking-content",children:i})})]})},n}(a().Component);var $=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Z=function(){return Z=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},Z.apply(this,arguments)},ee=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t};const ne=function(e){function n(n){var t=e.call(this,n)||this;return t.toggleSearchResults=function(e){t.setState((function(n){var t=new Set(n.expandedSearchResults);return t.has(e)?t.delete(e):t.add(e),{expandedSearchResults:t}}))},t.toggleDocumentContext=function(e){t.setState((function(n){var t=new Set(n.expandedDocumentContext);return t.has(e)?t.delete(e):t.add(e),{expandedDocumentContext:t}}))},t.renderSearchResult=function(e,n){return(0,r.jsxs)("div",{className:"search-result-item",children:[(0,r.jsxs)("div",{className:"search-result-header",children:[(0,r.jsxs)("span",{className:"search-result-number",children:[n+1,"."]}),(0,r.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"search-result-title",children:e.title})]}),(0,r.jsx)("div",{className:"search-result-url",children:e.url}),e.content&&(0,r.jsx)("div",{className:"search-result-content",children:e.content})]},n)},t.renderDocumentContext=function(e){var n=e.documentData;if(!n)return null;var o=t.state.expandedDocumentContext.has(e.id),a=n.results;return(0,r.jsx)("div",{className:"message message-ai message-document-context",children:(0,r.jsxs)("div",{className:"message-bubble",children:[(0,r.jsxs)("div",{className:"message-body",children:[(0,r.jsxs)("div",{className:"document-context-header",children:[(0,r.jsxs)("div",{className:"document-context-summary",children:[(0,r.jsx)("span",{className:"document-icon",children:""}),(0,r.jsx)("span",{className:"document-filename",children:1===a.length?a[0].filename:"".concat(a.length," documents")}),(0,r.jsx)("span",{className:"document-info",children:1===a.length?"".concat(a[0].file_type.toUpperCase(),"  ").concat(a[0].text_length," chars"):"".concat(a.length," files processed")})]}),(0,r.jsxs)("button",{onClick:function(){return t.toggleDocumentContext(e.id)},className:"document-toggle-btn",title:o?"Hide document content":"Show document content",children:[(0,r.jsx)("span",{className:"document-toggle-text",children:o?"Hide":"Show"}),(0,r.jsx)("span",{className:"document-toggle-icon ".concat(o?"expanded":""),children:o?"":""})]})]}),o&&(0,r.jsx)("div",{className:"document-context-content",children:(0,r.jsx)("div",{className:"document-content",children:n.context})})]}),(0,r.jsx)("div",{className:"message-meta",children:(0,r.jsx)("span",{className:"message-timestamp",children:S(e.timestamp)})})]})},e.id)},t.renderSearchResultsMessage=function(e){var n=e.searchData;if(!n)return null;var o=t.state.expandedSearchResults.has(e.id),a=n.scrapedContent&&n.successfulScrapes&&n.successfulScrapes>0;return(0,r.jsx)("div",{className:"message message-ai message-search-results",children:(0,r.jsxs)("div",{className:"message-bubble",children:[(0,r.jsxs)("div",{className:"message-body",children:[(0,r.jsxs)("div",{className:"search-results-header",children:[(0,r.jsxs)("div",{className:"search-results-summary",children:[(0,r.jsx)("span",{className:"search-icon",children:(0,r.jsx)(L,{})}),(0,r.jsxs)("span",{className:"search-query",children:['"',n.query,'"']}),(0,r.jsxs)("span",{className:"search-count",children:["(",n.totalResults," results)"]}),a&&(0,r.jsxs)("span",{className:"scraping-info",children:["+ ",n.successfulScrapes," pages scraped"]})]}),(0,r.jsxs)("button",{className:"search-toggle-btn",onClick:function(){return t.toggleSearchResults(e.id)},"aria-label":o?"Collapse search results":"Expand search results",children:[(0,r.jsx)("span",{className:"search-toggle-icon",children:o?"":""}),(0,r.jsx)("span",{className:"search-toggle-text",children:o?"Hide sources":"Show sources"})]})]}),o&&(0,r.jsxs)("div",{className:"search-results-content",children:[(0,r.jsx)("div",{className:"search-results-list",children:n.results.map((function(e,n){return t.renderSearchResult(e,n)}))}),a&&(0,r.jsx)("div",{className:"scraping-summary",children:(0,r.jsxs)("div",{className:"scraping-header",children:[(0,r.jsx)("span",{className:"scraping-icon",children:""}),(0,r.jsxs)("span",{children:["Detailed content scraped from ",n.successfulScrapes," web page(s)"]})]})})]})]}),(0,r.jsx)("div",{className:"message-meta",children:(0,r.jsx)("span",{className:"message-timestamp",children:S(e.timestamp)})})]})},e.id)},t.renderMessage=function(e){if(e.isSearchResults)return t.renderSearchResultsMessage(e);if(e.isDocumentContext)return t.renderDocumentContext(e);var n=e.sender,o=e.content,a=e.timestamp,s=e.isStreaming,i=e.isEditable,c=e.isEdited,l=e.canRegenerate,d=e.canContinue,u=e.showRawMarkdown,p=o.indexOf("<think>"),h=o,g=null;if(-1!==p){var m=o.slice(0,p),f=o.slice(p+7),b=f.indexOf("</think>");if(-1!==b){g=f.slice(0,b);var v=f.slice(b+8);h="".concat(m).concat(v)}else g=f,h=m;h=h.trim(),null!==g&&(g=g.trim())}var y,x=t.props.editingMessageId===e.id,w=["message","message-".concat(n),s?"message-streaming":"",x?"message-is-editing":"",u?"message-raw":""].filter(Boolean).join(" ");y=x?(0,r.jsxs)("div",{className:"message-edit-container",children:[(0,r.jsx)("textarea",{value:t.props.editingContent,onChange:function(e){return t.props.onEditingContentChange(e.target.value)},className:"message-edit-input",rows:Math.max(1,t.props.editingContent.split("\n").length),autoFocus:!0}),(0,r.jsxs)("div",{className:"message-edit-actions",children:[(0,r.jsx)("button",{onClick:t.props.onSaveEditing,className:"btn btn-primary btn-sm",disabled:!t.props.editingContent.trim(),children:"Save"}),(0,r.jsx)("button",{onClick:t.props.onCancelEditing,className:"btn btn-secondary btn-sm",children:"Cancel"})]})]}):"user"===n?(0,r.jsx)("div",{className:"message-text user-message-text",children:h}):u?(0,r.jsx)("pre",{className:"raw-markdown-content",children:(0,r.jsx)("code",{children:h})}):(0,r.jsx)(q.oz,{remarkPlugins:[G.A],components:{a:function(e){e.node;var n=ee(e,["node"]);return(0,r.jsx)("a",Z({},n,{target:"_blank",rel:"noopener noreferrer",className:"markdown-link"}))},code:function(n){n.node;var t=n.inline,o=n.className,a=n.children,s=ee(n,["node","inline","className","children"]),i=/language-(\w+)/.exec(o||""),c=String(a).replace(/\n$/,"");if(!t&&(c.includes("\n")||o)){var l="".concat(e.id,"-").concat(c.slice(0,50).replace(/\s/g,""),"-").concat(c.length);return(0,r.jsx)(X,{className:o,language:null==i?void 0:i[1],children:c},l)}return(0,r.jsx)("code",Z({className:"markdown-inline-code"},s,{children:c}))},blockquote:function(e){e.node;var n=ee(e,["node"]);return(0,r.jsx)("blockquote",Z({className:"markdown-blockquote"},n))},table:function(e){e.node;var n=ee(e,["node"]);return(0,r.jsx)("div",{className:"markdown-table-wrapper",children:(0,r.jsx)("table",Z({className:"markdown-table"},n))})},th:function(e){e.node;var n=ee(e,["node"]);return(0,r.jsx)("th",Z({className:"markdown-table-header"},n))},td:function(e){e.node;var n=ee(e,["node"]);return(0,r.jsx)("td",Z({className:"markdown-table-cell"},n))}},children:h});var k="user"===n&&i&&!x?(0,r.jsx)("button",{onClick:function(){return t.props.onStartEditing(e.id,o)},className:"message-action-btn",title:"Edit message",children:(0,r.jsx)(_,{})}):null,C="ai"!==n||s?null:(0,r.jsxs)("div",{className:"ai-message-actions",children:[(0,r.jsx)("button",{onClick:function(){var n,r;return null===(r=(n=t.props).onToggleMarkdown)||void 0===r?void 0:r.call(n,e.id)},className:"message-action-btn",title:u?"Show formatted view":"Show raw markdown",children:(0,r.jsx)(O,{})}),l&&(0,r.jsx)("button",{onClick:t.props.onRegenerateResponse,className:"message-action-btn",title:"Regenerate response",children:(0,r.jsx)(I,{})}),d&&(0,r.jsx)("button",{onClick:t.props.onContinueGeneration,className:"message-action-btn",title:"Continue generation",children:(0,r.jsx)(E,{})})]}),j=Boolean(k||C);return(0,r.jsx)("div",{className:w,"data-message-id":e.id,children:(0,r.jsxs)("div",{className:"message-bubble",children:[(0,r.jsxs)("div",{className:"message-body",children:["ai"===n&&g&&(0,r.jsx)(Q,{isStreaming:s,children:g}),(0,r.jsx)("div",{className:"message-content",children:y}),s&&0===h.length&&(0,r.jsxs)("span",{className:"typing-indicator",role:"status","aria-live":"polite",children:[(0,r.jsx)("span",{className:"typing-dot"}),(0,r.jsx)("span",{className:"typing-dot"}),(0,r.jsx)("span",{className:"typing-dot"})]})]}),(0,r.jsxs)("div",{className:"message-meta",children:[(0,r.jsx)("span",{className:"message-timestamp",children:S(a)}),c&&(0,r.jsx)("span",{className:"message-edited-indicator",children:"Edited"}),j&&(0,r.jsxs)("div",{className:"message-actions",children:[k,C]})]})]})},e.id)},t.renderLoadingIndicator=function(){return(0,r.jsx)("div",{className:"loading-indicator",children:(0,r.jsxs)("div",{className:"loading-dots",children:[(0,r.jsx)("div",{className:"loading-dot"}),(0,r.jsx)("div",{className:"loading-dot"}),(0,r.jsx)("div",{className:"loading-dot"})]})})},t.renderError=function(){return t.props.error?(0,r.jsx)("div",{className:"error-message",children:t.props.error}):null},t.renderEmptyState=function(){return t.props.messages.length>0?null:(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsx)("div",{className:"empty-state-icon",children:""}),(0,r.jsx)("div",{className:"empty-state-text",children:"Start a conversation by typing a message below."})]})},t.renderScrollToBottomButton=function(){var e=t.props,n=e.showScrollToBottom,o=e.onScrollToBottom;return n&&o?(0,r.jsx)("button",{type:"button",onClick:o,className:"scroll-to-bottom-button",title:"Scroll to bottom","aria-label":"Scroll to bottom",children:(0,r.jsx)(T,{})}):null},t.state={expandedSearchResults:new Set,expandedDocumentContext:new Set},t}return $(n,e),n.prototype.render=function(){var e=this,n=this.props,t=n.messages,o=n.isLoadingHistory,a=n.chatHistoryRef;return(0,r.jsxs)("div",{className:"chat-history-container",children:[(0,r.jsxs)("div",{ref:a,className:"chat-history",onScroll:this.props.onScroll,children:[this.renderError(),o&&this.renderLoadingIndicator(),o||0!==t.length?t.map((function(n){return e.renderMessage(n)})):this.renderEmptyState()]}),this.renderScrollToBottomButton()]})},n}(a().Component);var te=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();const re=function(e){function n(n){var t=e.call(this,n)||this;return t.menuRef=a().createRef(),t.handleClickOutside=function(e){t.menuRef.current&&!t.menuRef.current.contains(e.target)&&t.setState({isMenuOpen:!1})},t.updateMultilineState=function(){var e,n=null===(e=t.props.inputRef)||void 0===e?void 0:e.current;if(n){var r=window.getComputedStyle(n),o=parseFloat(r.lineHeight||"0")||24,a=n.scrollHeight>1.6*o;a!==t.state.isMultiline&&t.setState({isMultiline:a})}},t.handleInputChangeProxy=function(e){t.props.onInputChange(e),requestAnimationFrame(t.updateMultilineState)},t.toggleMenu=function(){t.setState((function(e){return{isMenuOpen:!e.isMenuOpen}}))},t.handleFileUpload=function(){t.props.onFileUpload&&t.props.onFileUpload(),t.setState({isMenuOpen:!1})},t.handleWebSearchToggle=function(){t.props.onToggleWebSearch&&t.props.onToggleWebSearch(),t.setState({isMenuOpen:!1})},t.handlePersonaToggle=function(){t.setState((function(e){var n=!e.showPersonaSelector;return!n&&t.props.onPersonaToggle&&t.props.onPersonaToggle(),console.log(" ChatInput: Persona toggle - newShowPersonaSelector: ".concat(n)),{showPersonaSelector:n,isMenuOpen:!1}}))},t.state={isMenuOpen:!1,showPersonaSelector:!1,isMultiline:!1},t}return te(n,e),n.prototype.componentDidMount=function(){var e;document.addEventListener("mousedown",this.handleClickOutside),console.log(" ChatInput mounted - showPersonaSelection: ".concat(this.props.showPersonaSelection,", selectedPersona: ").concat((null===(e=this.props.selectedPersona)||void 0===e?void 0:e.name)||"null")),this.updateMultilineState()},n.prototype.componentDidUpdate=function(e){var n,t;e.selectedPersona!==this.props.selectedPersona&&console.log(" ChatInput: Persona changed from ".concat((null===(n=e.selectedPersona)||void 0===n?void 0:n.name)||"null"," to ").concat((null===(t=this.props.selectedPersona)||void 0===t?void 0:t.name)||"null")),e.showPersonaSelection!==this.props.showPersonaSelection&&(console.log(" ChatInput: showPersonaSelection changed from ".concat(e.showPersonaSelection," to ").concat(this.props.showPersonaSelection)),!this.props.showPersonaSelection&&this.state.showPersonaSelector&&(console.log(" ChatInput: Syncing local state - turning off persona selector because personas are globally disabled"),this.setState({showPersonaSelector:!1}))),e.inputText!==this.props.inputText&&this.updateMultilineState()},n.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.handleClickOutside)},n.prototype.render=function(){var e=this,n=this.props,t=n.inputText,o=n.isLoading,a=n.isLoadingHistory,s=n.isStreaming,i=n.selectedModel,c=n.promptQuestion,l=(n.onInputChange,n.onKeyPress),d=n.onSendMessage,u=n.onStopGeneration,p=(n.useWebSearch,n.inputRef),h=n.personas,g=n.selectedPersona,m=n.onPersonaChange,f=n.showPersonaSelection;return(0,r.jsx)("div",{className:"chat-input-container",children:(0,r.jsx)("div",{className:"chat-input-wrapper",children:(0,r.jsx)("div",{className:"input-with-buttons",children:(0,r.jsxs)("div",{className:"chat-input-row ".concat(this.state.isMultiline?"multiline":""),children:[f&&(0,r.jsxs)("select",{value:(null==g?void 0:g.id)||"",onChange:m,className:"persona-selector",disabled:o||a,title:"Select persona",children:[(0,r.jsx)("option",{value:"",children:"No Persona"}),h.map((function(e){return(0,r.jsx)("option",{value:e.id,children:e.name},e.id)}))]}),(0,r.jsx)("textarea",{ref:p,value:t,onChange:this.handleInputChangeProxy,onKeyDown:function(n){l(n),requestAnimationFrame(e.updateMultilineState)},placeholder:c||"Type your message here...",className:"chat-input",disabled:o||a,rows:1}),(0,r.jsx)("button",{onClick:s?u:d,disabled:!t.trim()&&!s||a||!i,className:"input-button send-button ".concat(s?"stop-button":""),title:s?"Stop generation":"Send message",children:s?(0,r.jsx)(D,{}):(0,r.jsx)(A,{})})]})})})})},n}(a().Component),oe=function(e){return e.isInitializing?(0,r.jsxs)("div",{className:"loading-indicator",children:[(0,r.jsxs)("div",{className:"loading-dots",children:[(0,r.jsx)("div",{className:"loading-dot"}),(0,r.jsx)("div",{className:"loading-dot"}),(0,r.jsx)("div",{className:"loading-dot"})]}),(0,r.jsx)("div",{className:"loading-text",children:"Initializing chat..."})]}):null};var ae=function(){return ae=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},ae.apply(this,arguments)},se=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function i(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,i)}c((r=r.apply(e,n||[])).next())}))},ie=function(e,n){var t,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=i(0),s.throw=i(1),s.return=i(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},ce=function(){function e(e){this.currentUserId=null,this.services=e,this.initializeUserId()}return e.prototype.initializeUserId=function(){return se(this,void 0,void 0,(function(){var e,n,t;return ie(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),(null===(t=this.services)||void 0===t?void 0:t.api)?[4,this.services.api.get("/api/v1/auth/me")]:[3,2];case 1:(e=r.sent())&&e.id&&(this.currentUserId=e.id),r.label=2;case 2:return[3,4];case 3:return n=r.sent(),console.error("Error getting current user ID:",n),[3,4];case 4:return[2]}}))}))},e.prototype.sendPrompt=function(e,n,t,r){return se(this,arguments,void 0,(function(e,n,t,r,o,a,s,i,c,l){var d,u,p,h,g,m,f,b,v,y,x,S,k;return void 0===o&&(o="chat"),ie(this,(function(C){switch(C.label){case 0:if(!(null===(x=this.services)||void 0===x?void 0:x.api))throw new Error("API service not available");d=[{role:"user",content:e}],u="/api/v1/ai/providers/chat",p={provider:n.provider||"ollama",settings_id:n.providerId||"ollama_servers_settings",server_id:n.serverId,model:n.name,messages:d.map((function(e){return{role:e.role||"user",content:e.content}})),params:{temperature:.7,max_tokens:2048},stream:t,user_id:this.currentUserId||"current",conversation_id:r,conversation_type:o},console.log(" AIService sending request with conversation_id: ".concat(r||"null")),i&&(p.page_id=i.pageId,p.page_context=JSON.stringify({pageName:i.pageName,pageRoute:i.pageRoute,isStudioPage:i.isStudioPage})),c&&(p.persona_id=c.id,p.persona_system_prompt=c.system_prompt,p.persona_model_settings=c.model_settings,p.persona_sample_greeting=c.sample_greeting,c.model_settings&&(p.params=ae(ae({},p.params),c.model_settings))),C.label=1;case 1:if(C.trys.push([1,10,,11]),h=!1,!t||"function"!=typeof(null===(k=null===(S=this.services)||void 0===S?void 0:S.api)||void 0===k?void 0:k.postStreaming))return[3,6];C.label=2;case 2:return C.trys.push([2,4,,5]),[4,this.services.api.postStreaming(u,p,(function(e){try{if(null==l?void 0:l.signal.aborted)return;var n=e;if(e.startsWith("data: ")&&(n=e.substring(6)),!n.trim()||"[DONE]"===n.trim())return;var t=JSON.parse(n);t.conversation_id&&!r&&s(t.conversation_id);var o=w(t);o&&a(o)}catch(e){console.error("Error processing streaming chunk:",e)}}),{timeout:12e4,signal:null==l?void 0:l.signal})];case 3:return C.sent(),h=!0,[3,5];case 4:if(g=C.sent(),console.error("Streaming error:",g),g instanceof Error&&"AbortError"!==g.name)throw g;return[3,5];case 5:return[3,9];case 6:return C.trys.push([6,8,,9]),[4,this.services.api.post(u,p,{timeout:6e4})];case 7:if(m=C.sent(),(f=m.data||m).conversation_id&&!r&&s(f.conversation_id),!(b=w(f)))throw new Error("No response text received");return a(b),h=!0,[3,9];case 8:throw v=C.sent(),console.error("Non-streaming error:",v),v;case 9:return[2,h];case 10:return y=C.sent(),console.error("Error in sendPrompt:",y),a("Error: ".concat(y instanceof Error?y.message:"Unknown error occurred")),[2,!1];case 11:return[2]}}))}))},e.prototype.getCurrentUserId=function(){return this.currentUserId},e.prototype.loadConversationWithPersona=function(e){return se(this,void 0,void 0,(function(){var n,t;return ie(this,(function(r){switch(r.label){case 0:if(!(null===(t=this.services)||void 0===t?void 0:t.api))throw new Error("API service not available");r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.services.api.get("/api/v1/conversations/".concat(e,"/with-persona"))];case 2:return[2,r.sent()];case 3:throw n=r.sent(),console.error("Error loading conversation with persona:",n),n;case 4:return[2]}}))}))},e.prototype.updateConversationPersona=function(e,n){return se(this,void 0,void 0,(function(){var t,r;return ie(this,(function(o){switch(o.label){case 0:if(!(null===(r=this.services)||void 0===r?void 0:r.api))throw new Error("API service not available");o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.services.api.put("/api/v1/conversations/".concat(e,"/persona"),{persona_id:n})];case 2:return o.sent(),[3,4];case 3:throw t=o.sent(),console.error("Error updating conversation persona:",t),t;case 4:return[2]}}))}))},e.prototype.cancelGeneration=function(e){return se(this,void 0,void 0,(function(){var n,t;return ie(this,(function(r){switch(r.label){case 0:if(!(null===(t=this.services)||void 0===t?void 0:t.api)||!e)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.services.api.post("/api/v1/ai/providers/cancel",{conversation_id:e})];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),console.error("Error canceling generation:",n),[3,4];case 4:return[2]}}))}))},e}(),le=function(){return le=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},le.apply(this,arguments)},de=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function i(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,i)}c((r=r.apply(e,n||[])).next())}))},ue=function(e,n){var t,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=i(0),s.throw=i(1),s.return=i(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},pe=function(){function e(e){this.apiService=e||null,this.defaultOptions={format:"json",language:"en",safesearch:1,category:"general"}}return e.prototype.search=function(e){return de(this,arguments,void 0,(function(e,n){var t,r,o,a,s;return void 0===n&&(n={}),ue(this,(function(i){switch(i.label){case 0:if(!(null==e?void 0:e.trim()))throw new Error("Search query is required");if(!this.apiService)throw new Error("API service not available for authenticated requests");t=le(le({},this.defaultOptions),n),i.label=1;case 1:return i.trys.push([1,3,,4]),r={q:e.trim()},Object.entries(t).forEach((function(e){var n=e[0],t=e[1];null!=t&&"format"!==n&&(r[n]=t.toString())})),console.log(" Searching via BrainDrive API service with params:",r),[4,this.apiService.get("/api/v1/searxng/web",{params:r})];case 2:if(!(o=i.sent())||"object"!=typeof o)throw new Error("Invalid response format from SearXNG");return a={query:e.trim(),number_of_results:o.number_of_results||0,results:this.transformResults(o.results||[]),suggestions:o.suggestions||[],unresponsive_engines:o.unresponsive_engines||[]},console.log(" SearXNG search completed: ".concat(a.number_of_results," results")),[2,a];case 3:if(s=i.sent(),console.error(" SearXNG search error:",s),s instanceof Error){if(s.message.includes("401")||s.message.includes("Unauthorized"))throw new Error("Authentication failed. Please ensure you are logged in.");if(s.message.includes("502")||s.message.includes("503"))throw new Error("Search service is temporarily unavailable. Please try again later.");throw s}throw new Error(String(s));case 4:return[2]}}))}))},e.prototype.transformResults=function(e){return Array.isArray(e)?e.filter((function(e){return e&&"object"==typeof e})).map((function(e){return{title:e.title||"Untitled",url:e.url||"",content:e.content||e.snippet||"",engine:e.engine,score:e.score}})).filter((function(e){return e.url&&e.title})):[]},e.prototype.scrapeUrls=function(e){return de(this,arguments,void 0,(function(e,n){var t,r,o,a;return void 0===n&&(n=5e3),ue(this,(function(s){switch(s.label){case 0:if(!this.apiService)throw new Error("API service not available for scraping");if(!e||0===e.length)throw new Error("At least one URL is required for scraping");s.label=1;case 1:return s.trys.push([1,3,,4]),console.log(" Scraping ".concat(e.length," URLs via BrainDrive API...")),[4,this.apiService.post("/api/v1/searxng/scrape",e,{params:{max_content_length:n}})];case 2:return t=s.sent(),console.log(" Scraping completed: ".concat(null===(o=t.summary)||void 0===o?void 0:o.successful_scrapes,"/").concat(null===(a=t.summary)||void 0===a?void 0:a.total_urls," successful")),[2,t];case 3:if(r=s.sent(),console.error(" URL scraping error:",r),r instanceof Error){if(r.message.includes("401")||r.message.includes("Unauthorized"))throw new Error("Authentication failed for scraping. Please ensure you are logged in.");if(r.message.includes("502")||r.message.includes("503"))throw new Error("Scraping service is temporarily unavailable. Please try again later.");throw r}throw new Error(String(r));case 4:return[2]}}))}))},e.prototype.searchWithScraping=function(e){return de(this,arguments,void 0,(function(e,n,t,r){var o,a,s;return void 0===n&&(n={}),void 0===t&&(t=3),void 0===r&&(r=3e3),ue(this,(function(i){switch(i.label){case 0:return[4,this.search(e,n)];case 1:return 0===(o=i.sent()).results.length||0===(a=o.results.slice(0,t).map((function(e){return e.url})).filter((function(e){return e&&e.startsWith("http")}))).length?[2,{searchResponse:o,scrapedContent:{results:[],summary:{total_urls:0,successful_scrapes:0,total_content_length:0}}}]:[4,this.scrapeUrls(a,r)];case 2:return s=i.sent(),[2,{searchResponse:o,scrapedContent:s}]}}))}))},e.prototype.checkHealth=function(){return de(this,void 0,void 0,(function(){var e,n;return ue(this,(function(t){switch(t.label){case 0:if(!this.apiService)return[2,{accessible:!1,error:"API service not available"}];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.apiService.get("/api/v1/searxng/health")];case 2:return[2,{accessible:!0===(e=t.sent()).accessible,error:e.accessible?void 0:e.error}];case 3:return(n=t.sent())instanceof Error?[2,{accessible:!1,error:"Health check failed: ".concat(n.message)}]:[2,{accessible:!1,error:"Health check failed: Unknown error"}];case 4:return[2]}}))}))},e.prototype.setApiService=function(e){this.apiService=e},e.prototype.getApiService=function(){return this.apiService},e}(),he=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function i(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,i)}c((r=r.apply(e,n||[])).next())}))},ge=function(e,n){var t,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=i(0),s.throw=i(1),s.return=i(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},me=function(){function e(e){this.apiService=e||null}return e.prototype.setApiService=function(e){this.apiService=e},e.prototype.getApiService=function(){return this.apiService},e.prototype.getSupportedFileTypes=function(){return he(this,void 0,void 0,(function(){var e,n;return ge(this,(function(t){switch(t.label){case 0:if(!this.apiService)throw new Error("API service not available");t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.apiService.get("/api/v1/documents/supported-types")];case 2:return[2,(e=t.sent()).data||e];case 3:throw n=t.sent(),console.error("Error getting supported file types:",n),n;case 4:return[2]}}))}))},e.prototype.processDocument=function(e){return he(this,void 0,void 0,(function(){var n,t,r;return ge(this,(function(o){switch(o.label){case 0:if(!this.apiService)throw new Error("API service not available");o.label=1;case 1:return o.trys.push([1,3,,4]),(n=new FormData).append("file",e),console.log(" Processing document: ".concat(e.name," (").concat(e.type,", ").concat(e.size," bytes)")),[4,this.apiService.post("/api/v1/documents/process",n,{headers:{"Content-Type":"multipart/form-data"}})];case 2:return t=o.sent(),console.log(" Document processed successfully: ".concat(e.name)),[2,t.data||t];case 3:throw r=o.sent(),console.error(" Error processing document ".concat(e.name,":"),r),r;case 4:return[2]}}))}))},e.prototype.processMultipleDocuments=function(e){return he(this,void 0,void 0,(function(){var n,t,r,o;return ge(this,(function(a){switch(a.label){case 0:if(!this.apiService)throw new Error("API service not available");if(0===e.length)throw new Error("No files provided");if(e.length>10)throw new Error("Too many files. Maximum is 10 files");a.label=1;case 1:return a.trys.push([1,3,,4]),n=new FormData,e.forEach((function(e){n.append("files",e)})),console.log(" Processing ".concat(e.length," documents")),[4,this.apiService.post("/api/v1/documents/process-multiple",n,{headers:{"Content-Type":"multipart/form-data"}})];case 2:return t=a.sent(),r=t.data||t,console.log(" Documents processed: ".concat(r.successful_files,"/").concat(r.total_files," successful")),[2,r];case 3:throw o=a.sent(),console.error(" Error processing multiple documents:",o),o;case 4:return[2]}}))}))},e.prototype.isFileTypeSupported=function(e){return he(this,void 0,void 0,(function(){var n,t;return ge(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getSupportedFileTypes()];case 1:return n=r.sent(),[2,e.type in n.supported_types];case 2:return t=r.sent(),console.error("Error checking file type support:",t),[2,!1];case 3:return[2]}}))}))},e.prototype.isFileSizeValid=function(e){return he(this,void 0,void 0,(function(){var n,t,r;return ge(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getSupportedFileTypes()];case 1:return n=o.sent(),t=1024*n.max_file_size_mb*1024,[2,e.size<=t];case 2:return r=o.sent(),console.error("Error checking file size:",r),[2,!1];case 3:return[2]}}))}))},e.prototype.validateFile=function(e){return he(this,void 0,void 0,(function(){var n,t,r;return ge(this,(function(o){switch(o.label){case 0:return o.trys.push([0,7,,8]),[4,this.isFileTypeSupported(e)];case 1:return o.sent()?[3,3]:[4,this.getSupportedFileTypes()];case 2:return t=o.sent(),n=Object.keys(t.supported_types).join(", "),[2,{valid:!1,error:"Unsupported file type. Supported types: ".concat(n)}];case 3:return[4,this.isFileSizeValid(e)];case 4:return o.sent()?[3,6]:[4,this.getSupportedFileTypes()];case 5:return t=o.sent(),[2,{valid:!1,error:"File too large. Maximum size is ".concat(t.max_file_size_mb,"MB")}];case 6:return[2,{valid:!0}];case 7:return r=o.sent(),[2,{valid:!1,error:"Error validating file: ".concat(r instanceof Error?r.message:"Unknown error")}];case 8:return[2]}}))}))},e.prototype.formatTextForChatContext=function(e){var n=e.filename,t=e.file_type,r=e.extracted_text,o=e.text_length,a="[DOCUMENT CONTEXT - ".concat(n.toUpperCase(),"]\n");return a+="File Type: ".concat(t,"\n"),a+="Text Length: ".concat(o," characters\n"),(a+="Content:\n\n".concat(r,"\n\n"))+"[END DOCUMENT CONTEXT]"},e.prototype.formatMultipleTextsForChatContext=function(e){var n="[MULTIPLE DOCUMENTS CONTEXT]\n";return n+="Total Documents: ".concat(e.length,"\n\n"),e.forEach((function(e,t){n+="--- Document ".concat(t+1,": ").concat(e.filename," ---\n"),n+="Type: ".concat(e.file_type,"\n"),n+="Length: ".concat(e.text_length," characters\n"),n+="Content:\n".concat(e.extracted_text,"\n\n")})),n+="[END MULTIPLE DOCUMENTS CONTEXT]"},e}(),fe=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),be=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function i(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,i)}c((r=r.apply(e,n||[])).next())}))},ve=function(e,n){var t,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=i(0),s.throw=i(1),s.return=i(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};!function(e){function n(n){var t=e.call(this,n)||this;return t.fileInputRef=a().createRef(),t.initDocumentService=function(){return be(t,void 0,void 0,(function(){var e,n,t;return ve(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),this.props.apiService?(e=new me(this.props.apiService),this.setState({documentService:e}),[4,e.getSupportedFileTypes()]):[3,2];case 1:n=r.sent(),this.setState({supportedTypes:n}),r.label=2;case 2:return[3,4];case 3:return t=r.sent(),console.error("Error initializing document service:",t),[3,4];case 4:return[2]}}))}))},t.handleFileSelect=function(e){return be(t,void 0,void 0,(function(){var n,t,r,o,a,s,i,c,l,d;return ve(this,(function(u){switch(u.label){case 0:if(!(n=e.target.files)||0===n.length)return[2];if(!this.state.documentService)return this.props.onError("Document service not available"),[2];this.setState({isProcessing:!0}),u.label=1;case 1:u.trys.push([1,9,10,11]),t=Array.from(n),r=[],o=0,a=t,u.label=2;case 2:if(!(o<a.length))return[3,8];s=a[o],u.label=3;case 3:return u.trys.push([3,6,,7]),[4,this.state.documentService.validateFile(s)];case 4:return(i=u.sent()).valid?[4,this.state.documentService.processDocument(s)]:(this.props.onError("File ".concat(s.name,": ").concat(i.error)),[3,7]);case 5:return(c=u.sent()).processing_success?r.push(c):this.props.onError("Failed to process ".concat(s.name,": ").concat(c.error)),[3,7];case 6:return l=u.sent(),this.props.onError("Error processing ".concat(s.name,": ").concat(l instanceof Error?l.message:"Unknown error")),[3,7];case 7:return o++,[3,2];case 8:return r.length>0&&this.props.onDocumentsProcessed(r),[3,11];case 9:return d=u.sent(),this.props.onError("Error processing documents: ".concat(d instanceof Error?d.message:"Unknown error")),[3,11];case 10:return this.setState({isProcessing:!1}),this.fileInputRef.current&&(this.fileInputRef.current.value=""),[7];case 11:return[2]}}))}))},t.handleClick=function(){!t.props.disabled&&t.fileInputRef.current&&t.fileInputRef.current.click()},t.getAcceptedFileTypes=function(){return t.state.supportedTypes?Object.keys(t.state.supportedTypes.supported_types).join(","):""},t.state={isProcessing:!1,supportedTypes:null,documentService:null},t}fe(n,e),n.prototype.componentDidMount=function(){this.initDocumentService()},n.prototype.render=function(){var e=this.props,n=e.disabled,t=e.className,o=void 0===t?"":t,a=this.state,s=a.isProcessing,i=a.supportedTypes;return(0,r.jsxs)("div",{className:"file-upload-container ".concat(o),children:[(0,r.jsx)("input",{ref:this.fileInputRef,type:"file",multiple:!0,accept:this.getAcceptedFileTypes(),onChange:this.handleFileSelect,style:{display:"none"},disabled:n||s}),(0,r.jsx)("button",{onClick:this.handleClick,disabled:n||s,className:"file-upload-button",title:"Upload documents (PDF, TXT, CSV, JSON, Excel)",children:s?(0,r.jsxs)("div",{className:"file-upload-loading",children:[(0,r.jsx)("div",{className:"loading-spinner"}),(0,r.jsx)("span",{children:"Processing..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(z,{}),(0,r.jsx)("span",{children:"Upload Documents"})]})}),i&&(0,r.jsx)("div",{className:"file-upload-info",children:(0,r.jsxs)("small",{children:["Supported: PDF, TXT, CSV, JSON, Excel  Max: ",i.max_file_size_mb,"MB  Up to ",i.max_files_per_request," files"]})})]})}}(a().Component);var ye=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),xe=function(){return xe=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},xe.apply(this,arguments)},we=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function s(e){try{c(r.next(e))}catch(e){a(e)}}function i(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,i)}c((r=r.apply(e,n||[])).next())}))},Se=function(e,n){var t,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=i(0),s.throw=i(1),s.return=i(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],r=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},ke=function(e,n,t){if(t||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))},Ce=function(e){function n(n){var t,r,o=e.call(this,n)||this;return o.chatHistoryRef=a().createRef(),o.inputRef=a().createRef(),o.themeChangeListener=null,o.pageContextUnsubscribe=null,o.currentPageContext=null,o.STREAMING_SETTING_KEY="ai_prompt_chat_streaming_enabled",o.initialGreetingAdded=!1,o.aiService=null,o.searchService=null,o.documentService=null,o.currentStreamingAbortController=null,o.menuButtonRef=null,o.SCROLL_ANCHOR_OFFSET=420,o.MIN_VISIBLE_LAST_MESSAGE_HEIGHT=64,o.NEAR_BOTTOM_EPSILON=24,o.isProgrammaticScroll=!1,o.pendingPersonaRequestId=null,o.loadInitialData=function(){return we(o,void 0,void 0,(function(){return Se(this,(function(e){switch(e.label){case 0:return[4,Promise.all([this.loadProviderSettings(),this.fetchConversations()])];case 1:return e.sent(),[2]}}))}))},o.getSavedStreamingMode=function(){return we(o,void 0,void 0,(function(){var e,n,t,r;return Se(this,(function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),(null===(r=null===(t=this.props.services)||void 0===t?void 0:t.settings)||void 0===r?void 0:r.getSetting)?(e=this.getSettingKey(this.STREAMING_SETTING_KEY),[4,this.props.services.settings.getSetting(e)]):[3,4];case 1:return null!=(n=o.sent())?[3,3]:[4,this.props.services.settings.getSetting(this.STREAMING_SETTING_KEY)];case 2:n=o.sent(),o.label=3;case 3:if("boolean"==typeof n)return[2,n];o.label=4;case 4:return[2,null];case 5:return o.sent(),[2,null];case 6:return[2]}}))}))},o.loadSavedStreamingMode=function(){return we(o,void 0,void 0,(function(){var e;return Se(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getSavedStreamingMode()];case 1:return null!==(e=n.sent())&&this.setState({useStreaming:e}),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}))},o.saveStreamingMode=function(e){return we(o,void 0,void 0,(function(){var n,t,r;return Se(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(null===(r=null===(t=this.props.services)||void 0===t?void 0:t.settings)||void 0===r?void 0:r.setSetting)?(n=this.getSettingKey(this.STREAMING_SETTING_KEY),[4,this.props.services.settings.setSetting(n,e)]):[3,2];case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:return o.sent(),[3,4];case 4:return[2]}}))}))},o.toggleWebSearchMode=function(){return we(o,void 0,void 0,(function(){var e,n;return Se(this,(function(t){switch(t.label){case 0:if(e=!this.state.useWebSearch,this.setState({useWebSearch:e}),!e||!this.searchService)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.searchService.checkHealth()];case 2:return(n=t.sent()).accessible?this.addMessageToChat({id:x("search-enabled"),sender:"ai",content:" Web search enabled - I can now search the web to help answer your questions",timestamp:(new Date).toISOString()}):this.addMessageToChat({id:x("search-warning"),sender:"ai",content:" Web search enabled but the search service is not accessible. ".concat(n.error||"Please ensure SearXNG is running and the backend is connected."),timestamp:(new Date).toISOString()}),[3,4];case 3:return t.sent(),this.addMessageToChat({id:x("search-error"),sender:"ai",content:" Web search enabled but there was an error connecting to the search service",timestamp:(new Date).toISOString()}),[3,4];case 4:return[3,6];case 5:this.addMessageToChat({id:x("search-disabled"),sender:"ai",content:" Web search ".concat(e?"enabled":"disabled"),timestamp:(new Date).toISOString()}),t.label=6;case 6:return[2]}}))}))},o.initializeThemeService=function(){var e;if(null===(e=o.props.services)||void 0===e?void 0:e.theme)try{var n=o.props.services.theme.getCurrentTheme();o.setState({currentTheme:n}),o.themeChangeListener=function(e){o.setState({currentTheme:e})},o.props.services.theme.addThemeChangeListener(o.themeChangeListener)}catch(e){}},o.initializePageContextService=function(){var e;if(null===(e=o.props.services)||void 0===e?void 0:e.pageContext)try{o.currentPageContext=o.props.services.pageContext.getCurrentPageContext(),o.pageContextUnsubscribe=o.props.services.pageContext.onPageContextChange((function(e){o.currentPageContext=e,o.fetchConversations()}))}catch(e){console.warn("Failed to initialize page context service:",e)}},o.loadPersonas=function(){return we(o,void 0,void 0,(function(){var e,n,t,r,o,a=this;return Se(this,(function(s){switch(s.label){case 0:if(console.log(" Loading personas - availablePersonas: ".concat((null===(r=this.props.availablePersonas)||void 0===r?void 0:r.length)||0,", showPersonaSelection: ").concat(this.state.showPersonaSelection)),this.props.availablePersonas)return console.log(" Using provided personas: ".concat(this.props.availablePersonas.map((function(e){return e.name})).join(", "))),this.resolvePendingPersonaSelection(),[2];this.setState({isLoadingPersonas:!0}),s.label=1;case 1:return s.trys.push([1,5,,6]),(null===(o=this.props.services)||void 0===o?void 0:o.api)?[4,this.props.services.api.get("/api/v1/personas")]:[3,3];case 2:return e=s.sent(),n=e.personas||[],console.log(" Loaded personas from API: ".concat(n.map((function(e){return e.name})).join(", "))),this.setState({personas:n,isLoadingPersonas:!1},(function(){a.resolvePendingPersonaSelection()})),[3,4];case 3:this.setState({isLoadingPersonas:!1},(function(){a.resolvePendingPersonaSelection()})),s.label=4;case 4:return[3,6];case 5:return t=s.sent(),console.error("Error loading personas:",t),this.setState({personas:[],isLoadingPersonas:!1},(function(){a.resolvePendingPersonaSelection()})),[3,6];case 6:return[2]}}))}))},o.loadProviderSettings=function(){return we(o,void 0,void 0,(function(){var e,n,t,r,o,a,s,i,c,l,d,u,p,h,g,m,f,b,v,y,x,w,S,k,C=this;return Se(this,(function(M){switch(M.label){case 0:if(this.setState({isLoadingModels:!0,error:""}),!(null===(k=this.props.services)||void 0===k?void 0:k.api))return this.setState({isLoadingModels:!1,error:"API service not available"}),[2];M.label=1;case 1:return M.trys.push([1,13,,14]),[4,this.props.services.api.get("/api/v1/ai/providers/all-models")];case 2:if(e=M.sent(),n=e&&e.models||e&&e.data&&e.data.models||(Array.isArray(e)?e:[]),t=Array.isArray(n)?n.map((function(e){var n=e.provider||"ollama",t=j[n]||n,r=e.server_id||e.serverId||"unknown",o=e.server_name||e.serverName||"Unknown Server";return{name:e.name||e.id||"",provider:n,providerId:t,serverName:o,serverId:r}})):[],t.length>0)return r=!this.state.pendingModelKey&&!this.state.selectedModel,this.setState((function(e){return!e.pendingModelKey&&!e.selectedModel&&t.length>0?{models:t,isLoadingModels:!1,selectedModel:t[0]}:{models:t,isLoadingModels:!1,selectedModel:e.selectedModel}}),(function(){C.state.pendingModelKey?C.resolvePendingModelSelection():r&&C.state.selectedModel&&C.broadcastModelSelection(C.state.selectedModel)})),[2];M.label=3;case 3:return M.trys.push([3,11,,12]),[4,this.props.services.api.get("/api/v1/settings/instances",{params:{definition_id:"ollama_servers_settings",scope:"user",user_id:"current"}})];case 4:if(o=M.sent(),a=null,Array.isArray(o)&&o.length>0?a=o[0]:o&&"object"==typeof o&&(a=(s=o).data?Array.isArray(s.data)?s.data[0]:s.data:o),i=[],!a||!a.value)return[3,10];c="string"==typeof a.value?JSON.parse(a.value):a.value,l=Array.isArray(null==c?void 0:c.servers)?c.servers:[],d=0,u=l,M.label=5;case 5:if(!(d<u.length))return[3,10];p=u[d],M.label=6;case 6:return M.trys.push([6,8,,9]),h={server_url:encodeURIComponent(p.serverAddress),settings_id:"ollama_servers_settings",server_id:p.id},p.apiKey&&(h.api_key=p.apiKey),[4,this.props.services.api.get("/api/v1/ollama/models",{params:h})];case 7:for(g=M.sent(),m=Array.isArray(g)?g:[],f=0,b=m;f<b.length;f++)v=b[f],i.push({name:v.name,provider:"ollama",providerId:"ollama_servers_settings",serverName:p.serverName,serverId:p.id});return[3,9];case 8:return y=M.sent(),console.error("Fallback: error loading Ollama models for server",null==p?void 0:p.serverName,y),[3,9];case 9:return d++,[3,5];case 10:return i.length>0?(x=!this.state.pendingModelKey&&!this.state.selectedModel,this.setState((function(e){return!e.pendingModelKey&&!e.selectedModel&&i.length>0?{models:i,isLoadingModels:!1,selectedModel:i[0]}:{models:i,isLoadingModels:!1,selectedModel:e.selectedModel}}),(function(){C.state.pendingModelKey?C.resolvePendingModelSelection():x&&C.state.selectedModel&&C.broadcastModelSelection(C.state.selectedModel)})),[2]):(this.setState({models:i,isLoadingModels:!1},(function(){C.state.pendingModelKey&&C.resolvePendingModelSelection()})),[2]);case 11:return w=M.sent(),console.error("Fallback: error loading Ollama settings/models:",w),this.setState({models:[],selectedModel:null,isLoadingModels:!1}),[3,12];case 12:return[3,14];case 13:return S=M.sent(),console.error("Error loading models from all providers:",S),this.setState({models:[],selectedModel:null,isLoadingModels:!1,error:"Error loading models: ".concat(S.message||"Unknown error")}),[3,14];case 14:return[2]}}))}))},o.refreshConversationsList=function(){return we(o,void 0,void 0,(function(){var e,n,t,r,o,a,s,i,c,l,d=this;return Se(this,(function(u){switch(u.label){case 0:if(!(null===(l=this.props.services)||void 0===l?void 0:l.api))return[2];u.label=1;case 1:return u.trys.push([1,4,,5]),[4,this.props.services.api.get("/api/v1/auth/me")];case 2:return e=u.sent(),(n=e.id)?(t=this.getCurrentPageContext(),r={skip:0,limit:50,conversation_type:this.props.conversationType||"chat"},(null==t?void 0:t.pageId)&&(r.page_id=t.pageId),[4,this.props.services.api.get("/api/v1/users/".concat(n,"/conversations"),{params:r})]):[2];case 3:if(o=u.sent(),a=[],Array.isArray(o))a=o;else if(o&&o.data&&Array.isArray(o.data))a=o.data;else if(o)try{"object"==typeof o&&o.id&&o.user_id&&(a=[o])}catch(e){}return 0===a.length?(this.setState({conversations:[],isLoadingHistory:!1}),[2]):((s=a.filter((function(e){return e&&"object"==typeof e&&e.id&&e.user_id}))).sort((function(e,n){return e.updated_at&&n.updated_at?new Date(n.updated_at).getTime()-new Date(e.updated_at).getTime():e.updated_at&&!n.updated_at?-1:!e.updated_at&&n.updated_at?1:new Date(n.created_at).getTime()-new Date(e.created_at).getTime()})),i=this.state.conversation_id?s.find((function(e){return e.id===d.state.conversation_id})):null,this.setState({conversations:s,selectedConversation:i||this.state.selectedConversation}),[3,5]);case 4:return c=u.sent(),console.error("Error refreshing conversations list:",c),[3,5];case 5:return[2]}}))}))},o.fetchConversations=function(){return we(o,void 0,void 0,(function(){var e,n,t,r,o,a,s,i,c,l,d=this;return Se(this,(function(u){switch(u.label){case 0:if(!(null===(l=this.props.services)||void 0===l?void 0:l.api))return this.setState({isLoadingHistory:!1,error:"API service not available"}),[2];u.label=1;case 1:return u.trys.push([1,4,,5]),this.setState({isLoadingHistory:!0,error:""}),[4,this.props.services.api.get("/api/v1/auth/me")];case 2:if(e=u.sent(),!(n=e.id))throw new Error("Could not get current user ID");return t=this.getCurrentPageContext(),r={skip:0,limit:50,conversation_type:this.props.conversationType||"chat"},(null==t?void 0:t.pageId)&&(r.page_id=t.pageId),[4,this.props.services.api.get("/api/v1/users/".concat(n,"/conversations"),{params:r})];case 3:if(o=u.sent(),a=[],Array.isArray(o))a=o;else if(o&&o.data&&Array.isArray(o.data))a=o.data;else if(o)try{"object"==typeof o&&o.id&&o.user_id&&(a=[o])}catch(e){}return 0===a.length?(this.setState({conversations:[],isLoadingHistory:!1}),[2]):((s=a.filter((function(e){return e&&"object"==typeof e&&e.id&&e.user_id}))).sort((function(e,n){return e.updated_at&&n.updated_at?new Date(n.updated_at).getTime()-new Date(e.updated_at).getTime():e.updated_at&&!n.updated_at?-1:!e.updated_at&&n.updated_at?1:new Date(n.created_at).getTime()-new Date(e.created_at).getTime()})),i=s.length>0?s[0]:null,this.setState({conversations:s,selectedConversation:i,isLoadingHistory:!1},(function(){i&&!d.state.conversation_id&&d.loadConversationWithPersona(i.id)})),[3,5]);case 4:return 403===(c=u.sent()).status||c.response&&403===c.response.status||404===c.status||c.response&&404===c.response.status?this.setState({isLoadingHistory:!1,conversations:[],error:""}):this.setState({isLoadingHistory:!1,error:"Error loading conversations: ".concat(c.message||"Unknown error")}),[3,5];case 5:return[2]}}))}))},o.handleModelChange=function(e){var n=e.target.value,t=o.state.models.find((function(e){return"".concat(e.provider,"_").concat(e.serverId,"_").concat(e.name)===n}));t&&o.setState({selectedModel:t,pendingModelKey:null,pendingModelSnapshot:null},(function(){o.broadcastModelSelection(t)}))},o.broadcastModelSelection=function(e){var n;if(null===(n=o.props.services)||void 0===n?void 0:n.event){var t={type:"model.selection",content:{model:{name:e.name,provider:e.provider,providerId:e.providerId,serverName:e.serverName,serverId:e.serverId},timestamp:(new Date).toISOString()}};o.props.services.event.sendMessage("ai-prompt-chat",t.content)}},o.resolvePendingModelSelection=function(){var e=o.state,n=e.pendingModelKey,t=e.models,r=e.selectedModel,a=e.pendingModelSnapshot;if(n){var s=t.find((function(e){return o.getModelKeyFromInfo(e)===n}));if(s){var i=o.getModelKeyFromInfo(r)===n,c=Boolean(null==r?void 0:r.isTemporary),l=Boolean(s.isTemporary);return!r||!i||c&&!l?void o.setState({selectedModel:s,pendingModelKey:l?n:null,pendingModelSnapshot:l?a:null},(function(){l||o.broadcastModelSelection(s)})):void(l||o.setState({pendingModelKey:null,pendingModelSnapshot:null}))}a&&!t.some((function(e){return o.getModelKeyFromInfo(e)===n}))&&o.setState((function(e){return{models:ke(ke([],e.models,!0),[a],!1)}}))}else a&&o.setState({pendingModelSnapshot:null})},o.resolvePendingPersonaSelection=function(){var e,n=o.state,t=n.pendingPersonaId,r=n.showPersonaSelection,a=n.personas,s=n.selectedPersona;if(r){if(t){var i="".concat(t);if(s&&"".concat(s.id)===i)o.setState({pendingPersonaId:null});else{var c=a.find((function(e){return"".concat(e.id)===i}));c?o.setState({selectedPersona:c,pendingPersonaId:null}):(null===(e=o.props.services)||void 0===e?void 0:e.api)&&o.pendingPersonaRequestId!==i&&(o.pendingPersonaRequestId=i,o.fetchPersonaById(i).then((function(e){if(e){var n="".concat(e.id);o.state.pendingPersonaId&&"".concat(o.state.pendingPersonaId)===n&&o.setState((function(t){var r=t.personas.some((function(e){return"".concat(e.id)===n}))?t.personas:ke(ke([],t.personas,!0),[xe(xe({},e),{id:n})],!1);return{personas:r,selectedPersona:r.find((function(e){return"".concat(e.id)===n}))||null,pendingPersonaId:null}}))}})).catch((function(e){console.error("Error resolving pending persona:",e)})).finally((function(){o.pendingPersonaRequestId=null})))}}}else t&&o.setState({pendingPersonaId:null})},o.fetchPersonaById=function(e){return we(o,void 0,void 0,(function(){var n,t,r,o;return Se(this,(function(a){switch(a.label){case 0:if(!(null===(o=this.props.services)||void 0===o?void 0:o.api))return[2,null];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.props.services.api.get("/api/v1/personas/".concat(e))];case 2:return n=a.sent(),(t=(null==n?void 0:n.persona)||(null==n?void 0:n.data)||n)&&t.id?[2,xe(xe({},t),{id:"".concat(t.id)})]:[3,4];case 3:return r=a.sent(),console.error("Error fetching persona by id:",r),[3,4];case 4:return[2,null]}}))}))},o.handleConversationSelect=function(e){var n=e.target.value;if(console.log(" Conversation selected: ".concat(n||"new chat")),n){var t=o.state.conversations.find((function(e){return e.id===n}));t&&(console.log(" Loading conversation: ".concat(n)),o.setState({selectedConversation:t},(function(){o.loadConversationWithPersona(n)})))}else o.handleNewChatClick()},o.handlePersonaChange=function(e){return we(o,void 0,void 0,(function(){var n,t,r,o=this;return Se(this,(function(a){switch(a.label){case 0:if(n=e.target.value,t=n&&this.state.personas.find((function(e){return e.id===n}))||null,console.log(" Persona changed: ".concat((null==t?void 0:t.name)||"none"," (ID: ").concat(n||"none",")")),this.setState({selectedPersona:t,pendingPersonaId:null},(function(){var e;console.log(" Persona state after change: selectedPersona=".concat((null===(e=o.state.selectedPersona)||void 0===e?void 0:e.name)||"null",", showPersonaSelection=").concat(o.state.showPersonaSelection))})),!this.state.conversation_id)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.updateConversationPersona(this.state.conversation_id,n||null)];case 2:return a.sent(),[3,4];case 3:return r=a.sent(),console.error("Failed to update conversation persona:",r),[3,4];case 4:return[2]}}))}))},o.handlePersonaToggle=function(){console.log(" Persona toggled off - resetting to no persona"),o.setState({selectedPersona:null,pendingPersonaId:null},(function(){var e;console.log(" Persona state after toggle: selectedPersona=".concat((null===(e=o.state.selectedPersona)||void 0===e?void 0:e.name)||"null",", showPersonaSelection=").concat(o.state.showPersonaSelection))}))},o.handleNewChatClick=function(){console.log(" Starting new chat - clearing conversation_id"),o.setState({selectedConversation:null,conversation_id:null,messages:[],selectedPersona:o.state.showPersonaSelection?o.state.selectedPersona:null,pendingModelKey:null,pendingModelSnapshot:null,pendingPersonaId:null},(function(){var e,n;console.log(" New chat started - conversation_id: ".concat(o.state.conversation_id));var t=o.state.showPersonaSelection&&(null===(e=o.state.selectedPersona)||void 0===e?void 0:e.sample_greeting),r=t||o.props.initialGreeting;console.log(" New chat greeting: showPersonaSelection=".concat(o.state.showPersonaSelection,", selectedPersona=").concat((null===(n=o.state.selectedPersona)||void 0===n?void 0:n.name)||"none",", using=").concat(t?"persona":"default"," greeting")),r&&(o.initialGreetingAdded=!0,o.addMessageToChat({id:x("greeting"),sender:"ai",content:r,timestamp:(new Date).toISOString()}))}))},o.handleRenameConversation=function(e,n){return we(o,void 0,void 0,(function(){var t,r,o,a;return Se(this,(function(s){switch(s.label){case 0:if(this.setState({openConversationMenu:null}),!n){if(t=this.state.conversations.find((function(n){return n.id===e})),!(r=prompt("Enter new name:",(null==t?void 0:t.title)||"Untitled")))return[2];n=r}if(!(null===(a=this.props.services)||void 0===a?void 0:a.api))throw new Error("API service not available");s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.props.services.api.put("/api/v1/conversations/".concat(e),{title:n})];case 2:return s.sent(),this.setState((function(t){var r;return{conversations:t.conversations.map((function(t){return t.id===e?xe(xe({},t),{title:n}):t})),selectedConversation:(null===(r=t.selectedConversation)||void 0===r?void 0:r.id)===e?xe(xe({},t.selectedConversation),{title:n}):t.selectedConversation}})),[3,4];case 3:throw o=s.sent(),new Error("Error renaming conversation: ".concat(o.message||"Unknown error"));case 4:return[2]}}))}))},o.toggleConversationMenu=function(e,n){console.log(" toggleConversationMenu called:",{conversationId:e,hasEvent:!!n});var t=o.state.openConversationMenu!==e;console.log(" isOpening:",t),t?o.setState({openConversationMenu:e},(function(){console.log(" Menu opened for conversation:",e)})):(console.log(" Closing menu"),o.setState({openConversationMenu:null}))},o.handleShareConversation=function(e){return we(o,void 0,void 0,(function(){var n;return Se(this,(function(t){switch(t.label){case 0:this.setState({openConversationMenu:null}),t.label=1;case 1:return t.trys.push([1,3,,4]),n="".concat(window.location.origin).concat(window.location.pathname,"?conversation=").concat(e),[4,navigator.clipboard.writeText(n)];case 2:return t.sent(),this.addMessageToChat({id:x("share-success"),sender:"ai",content:" Conversation link copied to clipboard!",timestamp:(new Date).toISOString()}),[3,4];case 3:return t.sent(),this.addMessageToChat({id:x("share-error"),sender:"ai",content:" Failed to copy conversation link",timestamp:(new Date).toISOString()}),[3,4];case 4:return[2]}}))}))},o.handleDeleteConversation=function(e){return we(o,void 0,void 0,(function(){var n,t,r=this;return Se(this,(function(o){switch(o.label){case 0:if(this.setState({openConversationMenu:null}),!(null===(t=this.props.services)||void 0===t?void 0:t.api))throw new Error("API service not available");o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.props.services.api.delete("/api/v1/conversations/".concat(e))];case 2:return o.sent(),this.setState((function(n){var t,r=n.conversations.filter((function(n){return n.id!==e})),o=(null===(t=n.selectedConversation)||void 0===t?void 0:t.id)===e;return{conversations:r,selectedConversation:o?null:n.selectedConversation,conversation_id:o?null:n.conversation_id,messages:o?[]:n.messages,selectedPersona:o?n.showPersonaSelection?n.selectedPersona:null:n.selectedPersona}}),(function(){if(null===r.state.selectedConversation){var e=r.state.showPersonaSelection?r.state.selectedPersona:null,n=r.state.showPersonaSelection&&(null==e?void 0:e.sample_greeting)||r.props.initialGreeting;n&&(r.initialGreetingAdded=!0,r.addMessageToChat({id:x("greeting"),sender:"ai",content:n,timestamp:(new Date).toISOString()}))}})),[3,4];case 3:throw n=o.sent(),new Error("Error deleting conversation: ".concat(n.message||"Unknown error"));case 4:return[2]}}))}))},o.loadConversationHistory=function(e){return we(o,void 0,void 0,(function(){var n,t,r,o=this;return Se(this,(function(a){switch(a.label){case 0:if(console.log(" Loading conversation history: ".concat(e)),!(null===(r=this.props.services)||void 0===r?void 0:r.api))return this.setState({error:"API service not available",isInitializing:!1}),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),console.log(" Clearing messages for conversation load: ".concat(e)),this.setState({messages:[],conversation_id:null,isLoadingHistory:!0,error:""}),[4,this.props.services.api.get("/api/v1/conversations/".concat(e,"/with-messages"))];case 2:return n=a.sent(),this.initialGreetingAdded=!0,t=[],n&&n.messages&&Array.isArray(n.messages)&&t.push.apply(t,n.messages.map((function(e){return{id:e.id||x("history"),sender:"llm"===e.sender?"ai":"user",content:o.cleanMessageContent(e.message),timestamp:e.created_at}}))),this.setState({messages:t,conversation_id:e,isLoadingHistory:!1,isInitializing:!1}),console.log(" Conversation history loaded: ".concat(e,", ").concat(t.length," messages")),setTimeout((function(){return o.scrollToBottom()}),100),[3,4];case 3:return a.sent(),this.setState({isLoadingHistory:!1,error:"Error loading conversation history",isInitializing:!1}),[3,4];case 4:return[2]}}))}))},o.loadConversationWithPersona=function(e){return we(o,void 0,void 0,(function(){var n,t,r,o,a,s,i,c,l,d,u,p,h,g,m,f,b,v=this;return Se(this,(function(y){switch(y.label){case 0:if(console.log(" Loading conversation with persona: ".concat(e)),!(null===(m=this.props.services)||void 0===m?void 0:m.api)||!this.aiService)return this.setState({error:"API service not available",isInitializing:!1}),[2];y.label=1;case 1:y.trys.push([1,7,,9]),this.setState({messages:[],conversation_id:null,isLoadingHistory:!0,error:""}),n=this.state.selectedConversation,t=null,y.label=2;case 2:return y.trys.push([2,4,,5]),[4,this.aiService.loadConversationWithPersona(e)];case 3:return t=y.sent(),[3,5];case 4:return y.sent(),console.warn("Persona-aware conversation loading not available, falling back to regular loading"),t=n,[3,5];case 5:return r=this.state.showPersonaSelection,o=r&&(null==t?void 0:t.persona)?xe(xe({},t.persona),{id:"".concat(t.persona.id)}):null,a=r?(null==o?void 0:o.id)||((null==t?void 0:t.persona_id)?"".concat(t.persona_id):null):null,s=a&&""!==a.trim()?a:null,i=null===(f=null==t?void 0:t.model)||void 0===f?void 0:f.trim(),c=null===(b=null==t?void 0:t.server)||void 0===b?void 0:b.trim(),l=Boolean(i&&c),d=l?this.getModelKey(i,c):null,u=d?this.state.models.find((function(e){return v.getModelKeyFromInfo(e)===d})):null,p=d&&!u&&l?{name:i,provider:"ollama",providerId:"ollama_servers_settings",serverName:c,serverId:"unknown",isTemporary:!0}:null,h=this.getModelKeyFromInfo(this.state.selectedModel),this.setState((function(e){var n={pendingModelKey:d,pendingModelSnapshot:p,pendingPersonaId:s};if(u?n.selectedModel=u:p?n.selectedModel=p:d||(n.pendingModelKey=null,n.pendingModelSnapshot=null),r)if(o)(t=e.personas.find((function(e){return"".concat(e.id)===o.id})))?n.selectedPersona=t:(n.personas=ke(ke([],e.personas,!0),[o],!1),n.selectedPersona=o);else if(s){n.pendingPersonaId=s;var t=e.personas.find((function(e){return"".concat(e.id)===s}));n.selectedPersona=t||null}else n.selectedPersona=null,n.pendingPersonaId=null;else n.selectedPersona=null,n.pendingPersonaId=null;return n}),(function(){var e=v.getModelKeyFromInfo(v.state.selectedModel);if((u||p)&&e&&e!==h){var n=v.state.selectedModel;n&&v.broadcastModelSelection(n)}d&&v.resolvePendingModelSelection(),v.state.pendingPersonaId&&v.resolvePendingPersonaSelection()})),[4,this.loadConversationHistory(e)];case 6:return y.sent(),console.log(" Conversation loaded successfully: ".concat(e)),[3,9];case 7:return g=y.sent(),console.error("Error loading conversation with persona:",g),[4,this.loadConversationHistory(e)];case 8:return y.sent(),[3,9];case 9:return[2]}}))}))},o.updateConversationPersona=function(e,n){return we(o,void 0,void 0,(function(){var t;return Se(this,(function(r){switch(r.label){case 0:if(!this.aiService)throw new Error("AI service not available");r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.aiService.updateConversationPersona(e,n)];case 2:return r.sent(),[3,4];case 3:throw t=r.sent(),console.error("Error updating conversation persona:",t),t;case 4:return[2]}}))}))},o.stopGeneration=function(){return we(o,void 0,void 0,(function(){var e,n=this;return Se(this,(function(t){switch(t.label){case 0:if(console.log(" stopGeneration called"),this.currentStreamingAbortController&&(this.currentStreamingAbortController.abort(),this.currentStreamingAbortController=null),!this.aiService||!this.state.conversation_id)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.aiService.cancelGeneration(this.state.conversation_id)];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),console.error("Error canceling backend generation:",e),[3,4];case 4:return this.setState((function(e){return console.log(" Updating message states, current messages:",e.messages.length),{isStreaming:!1,isLoading:!1,messages:e.messages.map((function(e){var n=e.isStreaming;return n&&console.log(" Updating streaming message ".concat(e.id," with canContinue: true, isCutOff: true")),xe(xe({},e),{isStreaming:!1,canRegenerate:!0,canContinue:!!n||e.canContinue,isCutOff:!!n||e.isCutOff})}))}}),(function(){console.log(" Message states updated, focusing input"),n.focusInput()})),[2]}}))}))},o.continueGeneration=function(){return we(o,void 0,void 0,(function(){var e,n,t=this;return Se(this,(function(r){if((e=this.state.messages.filter((function(e){return"ai"===e.sender})).pop())&&e.canContinue){if(!(n=ke([],this.state.messages,!0).reverse().find((function(e){return"user"===e.sender}))))return[2];this.setState((function(n){return{messages:n.messages.filter((function(n){return n.id!==e.id}))}}),(function(){return we(t,void 0,void 0,(function(){return Se(this,(function(e){switch(e.label){case 0:return[4,this.sendPromptToAI(n.content)];case 1:return e.sent(),[2]}}))}))}))}return[2]}))}))},o.regenerateResponse=function(){return we(o,void 0,void 0,(function(){var e,n=this;return Se(this,(function(t){return(e=this.state.messages.filter((function(e){return"user"===e.sender})).pop())&&this.setState((function(n){var t=n.messages.findIndex((function(n){return n.id===e.id}));return{messages:n.messages.slice(0,t+1)}}),(function(){n.sendPromptToAI(e.content)})),[2]}))}))},o.startEditingMessage=function(e,n){o.setState({editingMessageId:e,editingContent:n})},o.cancelEditingMessage=function(){o.setState({editingMessageId:null,editingContent:""})},o.toggleMarkdownView=function(e){o.setState((function(n){return{messages:n.messages.map((function(n){return n.id===e?xe(xe({},n),{showRawMarkdown:!n.showRawMarkdown}):n}))}}))},o.saveEditedMessage=function(){return we(o,void 0,void 0,(function(){var e,n,t,r=this;return Se(this,(function(o){return e=this.state,n=e.editingMessageId,t=e.editingContent,n&&t.trim()?(this.setState((function(e){return{messages:e.messages.map((function(e){return e.id===n?xe(xe({},e),{content:t.trim(),isEdited:!0,originalContent:e.originalContent||e.content}):e})),editingMessageId:null,editingContent:""}}),(function(){return we(r,void 0,void 0,(function(){var e,t=this;return Se(this,(function(r){return(e=this.state.messages.find((function(e){return e.id===n})))&&this.setState((function(e){return{messages:e.messages.slice(0,e.messages.findIndex((function(e){return e.id===n}))+1)}}),(function(){t.sendPromptToAI(e.content)})),[2]}))}))})),[2]):[2]}))}))},o.handleFileUploadClick=function(){var e=document.createElement("input");e.type="file",e.multiple=!0,e.accept=".pdf,.txt,.csv,.json,.xlsx,.xls,.md,.xml,.html",e.style.display="none",e.onchange=function(e){return we(o,void 0,void 0,(function(){var n,t,r,o,a,s,i,c,l,d;return Se(this,(function(u){switch(u.label){case 0:if(!(n=e.target.files)||0===n.length)return[2];if(!this.documentService)return this.setState({error:"Document service not available"}),[2];this.setState({isProcessingDocuments:!0}),u.label=1;case 1:u.trys.push([1,9,10,11]),t=Array.from(n),r=[],o=0,a=t,u.label=2;case 2:if(!(o<a.length))return[3,8];s=a[o],u.label=3;case 3:return u.trys.push([3,6,,7]),[4,this.documentService.validateFile(s)];case 4:return(i=u.sent()).valid?[4,this.documentService.processDocument(s)]:(this.setState({error:"File ".concat(s.name,": ").concat(i.error)}),[3,7]);case 5:return(c=u.sent()).processing_success?r.push(c):this.setState({error:"Failed to process ".concat(s.name,": ").concat(c.error)}),[3,7];case 6:return l=u.sent(),this.setState({error:"Error processing ".concat(s.name,": ").concat(l instanceof Error?l.message:"Unknown error")}),[3,7];case 7:return o++,[3,2];case 8:return r.length>0&&this.handleDocumentsProcessed(r),[3,11];case 9:return d=u.sent(),this.setState({error:"Error processing documents: ".concat(d instanceof Error?d.message:"Unknown error")}),[3,11];case 10:return this.setState({isProcessingDocuments:!1}),[7];case 11:return[2]}}))}))},document.body.appendChild(e),e.click(),document.body.removeChild(e)},o.handleDocumentsProcessed=function(e){if(0!==e.length){var n;n=1===e.length?o.documentService.formatTextForChatContext(e[0]):o.documentService.formatMultipleTextsForChatContext(e),o.setState({documentContext:n},(function(){var t={id:x("documents"),sender:"ai",content:"",timestamp:(new Date).toISOString(),isDocumentContext:!0,documentData:{results:e,context:n}};o.addMessageToChat(t)}))}},o.handleDocumentError=function(e){o.setState({error:e})},o.handleGlobalKeyPress=function(e){"Escape"===e.key&&o.state.isStreaming&&(e.preventDefault(),o.stopGeneration()),"Escape"===e.key&&o.state.openConversationMenu&&(e.preventDefault(),o.setState({openConversationMenu:null}))},o.handleClickOutside=function(e){if(o.state.openConversationMenu){var n=e.target;n.closest(".history-action-button")||n.closest(".conversation-menu")||o.setState({openConversationMenu:null})}},o.toggleHistoryAccordion=function(){o.setState((function(e){return{isHistoryExpanded:!e.isHistoryExpanded}}))},o.autoCloseAccordionsOnFirstMessage=function(){1!==o.state.messages.filter((function(e){return"user"===e.sender})).length||o.state.conversation_id||o.setState({isHistoryExpanded:!1})},o.buildSearchContextForPrompt=function(e,n){var t='Search Results for "'.concat(e.query,'":\n\n');return e.results&&e.results.length>0&&e.results.slice(0,5).forEach((function(e,n){if(t+="".concat(n+1,". ").concat(e.title,"\n"),t+="   URL: ".concat(e.url,"\n"),e.content){var r=e.content.replace(/\s+/g," ").trim().substring(0,200);t+="   Summary: ".concat(r).concat(e.content.length>200?"...":"","\n")}t+="\n"})),n&&n.results&&n.results.length>0&&(t+="\nDetailed Content from Web Pages:\n\n",n.results.forEach((function(n,r){if(n.success&&n.content){var o=e.results.find((function(e){return e.url===n.url})),a=(null==o?void 0:o.title)||"Content from ".concat(n.url);t+="Page ".concat(r+1,": ").concat(a,"\n"),t+="Source: ".concat(n.url,"\n"),t+="Full Content: ".concat(n.content,"\n\n")}})),t+="(Successfully scraped ".concat(n.summary.successful_scrapes," out of ").concat(n.summary.total_urls," pages)\n")),t+="\nPlease use this web search and scraped content information to provide an accurate, up-to-date answer to the user's question."},o.cleanMessageContent=function(e){if(!e)return e;var n=e.replace(/\r\n/g,"\n").replace(/\n{3,}/g,"\n\n").trim();return(n=(n=(n=n.replace(/\n\n\[WEB SEARCH CONTEXT[^]*$/,"")).replace(/^Document Context:[^]*?\n\nUser Question: /,"")).replace(/^[^]*?\n\nUser Question: /,"")).trim()},o.addMessageToChat=function(e){var n=xe(xe({},e),{content:o.cleanMessageContent(e.content)});console.log(" Adding message to chat: ".concat(n.sender," - ").concat(n.content.substring(0,50),"...")),o.setState((function(e){return{messages:ke(ke([],e.messages,!0),[n],!1)}}),(function(){console.log(" Message added. Total messages: ".concat(o.state.messages.length))}))},o.getEffectiveAnchorOffset=function(e){var n=Math.max(o.SCROLL_ANCHOR_OFFSET,0);if(0===n)return 0;var t=e.querySelector(".message:last-of-type");if(!t)return n;var r=t.offsetHeight,a=Math.max(r-o.MIN_VISIBLE_LAST_MESSAGE_HEIGHT,0);return Math.min(n,a)},o.isUserNearBottom=function(){if(!o.chatHistoryRef.current)return!0;var e=o.chatHistoryRef.current,n=e.scrollTop,t=e.scrollHeight-(n+e.clientHeight),r=o.getEffectiveAnchorOffset(e);return t<=Math.max(r,o.NEAR_BOTTOM_EPSILON)},o.updateScrollState=function(e){if(void 0===e&&(e={}),o.chatHistoryRef.current){var n=e.fromUser,t=void 0!==n&&n,r=o.chatHistoryRef.current,a=r.scrollTop,s=r.scrollHeight-(a+r.clientHeight),i=o.getEffectiveAnchorOffset(r),c=s<=Math.max(i,o.NEAR_BOTTOM_EPSILON),l=!c;o.setState((function(e){var n=e.isAutoScrollLocked;return t?n=!c:c&&e.isAutoScrollLocked&&(n=!1),e.isNearBottom===c&&e.showScrollToBottom===l&&e.isAutoScrollLocked===n?null:{isNearBottom:c,showScrollToBottom:l,isAutoScrollLocked:n}}))}},o.handleScroll=function(){o.isProgrammaticScroll?o.updateScrollState():o.updateScrollState({fromUser:!0})},o.scrollToBottom=function(e){if(void 0===e&&(e={}),o.chatHistoryRef.current){var n=e.behavior,t=void 0===n?"auto":n,r=e.manual,a=void 0!==r&&r,s=o.chatHistoryRef.current,i=o.getEffectiveAnchorOffset(s),c=Math.max(s.scrollHeight-s.clientHeight,0),l=Math.max(c-i,0);if(o.isProgrammaticScroll=!0,"function"==typeof s.scrollTo)try{s.scrollTo({top:l,behavior:t})}catch(e){s.scrollTop=l}else s.scrollTop=l;a&&o.state.isAutoScrollLocked&&o.setState({isAutoScrollLocked:!1});var d=function(){o.isProgrammaticScroll=!1,o.updateScrollState({fromUser:a})};"undefined"!=typeof window&&"function"==typeof window.requestAnimationFrame?window.requestAnimationFrame(d):setTimeout(d,0)}},o.focusInput=function(){o.inputRef.current&&setTimeout((function(){o.inputRef.current&&o.inputRef.current.focus()}),100)},o.handleInputChange=function(e){if(o.setState({inputText:e.target.value}),o.inputRef.current){var n=o.inputRef.current;n.style.height="auto";var t=window.getComputedStyle(n),r=4*(parseFloat(t.lineHeight||"0")||24);n.style.height="".concat(Math.min(n.scrollHeight,r),"px")}},o.handleKeyPress=function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),o.handleSendMessage())},o.handleSendMessage=function(){var e=o.state.inputText;if(e.trim()&&!o.state.isLoading){var n=x("user"),t={id:n,sender:"user",content:e.trim(),timestamp:(new Date).toISOString(),isEditable:!0};o.addMessageToChat(t),o.setState({inputText:""}),o.inputRef.current&&(o.inputRef.current.style.height="auto"),o.sendPromptToAI(t.content,n),o.autoCloseAccordionsOnFirstMessage()}},o.sendPromptToAI=function(e,n){return we(o,void 0,void 0,(function(){var n,t,r,o,a,s,i,c,l,d,u,p,h,g,m,f,b=this;return Se(this,(function(v){switch(v.label){case 0:if(!this.aiService||!(null===(f=this.props.services)||void 0===f?void 0:f.api))return this.setState({error:"API service not available"}),[2];if(!this.state.selectedModel)return this.setState({error:"Please select a model first"}),[2];console.log(" Sending prompt to AI with conversation_id: ".concat(this.state.conversation_id||"null (will create new)")),v.label=1;case 1:if(v.trys.push([1,7,,8]),this.setState({isLoading:!0,isStreaming:!0,error:""}),this.currentStreamingAbortController=new AbortController,n=e,this.state.documentContext&&(n="".concat(this.state.documentContext,"\n\nUser Question: ").concat(e)),!this.state.useWebSearch||!this.searchService)return[3,5];v.label=2;case 2:return v.trys.push([2,4,,5]),this.setState({isSearching:!0}),t=x("search-indicator"),this.addMessageToChat({id:t,sender:"ai",content:" Searching the web...",timestamp:(new Date).toISOString()}),[4,this.searchService.searchWithScraping(e,{category:"general",language:"en"},3,3e3)];case 3:return r=v.sent(),o=r.searchResponse,a=r.scrapedContent,this.setState((function(e){return{messages:e.messages.filter((function(e){return e.id!==t}))}})),o.results.length>0?(s={id:x("search-results"),sender:"ai",content:"",timestamp:(new Date).toISOString(),isSearchResults:!0,searchData:{query:o.query,results:o.results.slice(0,5),scrapedContent:a,totalResults:o.results.length,successfulScrapes:a.summary.successful_scrapes}},this.addMessageToChat(s),i=this.buildSearchContextForPrompt(o,a),n="".concat(e,"\n\n[WEB SEARCH CONTEXT - Use this information to answer the user's question]\n").concat(i)):this.addMessageToChat({id:x("search-no-results"),sender:"ai",content:"No web search results found for your query. I will answer based on my knowledge.",timestamp:(new Date).toISOString()}),this.setState({isSearching:!1}),[3,5];case 4:return c=v.sent(),console.error("Web search error:",c),this.setState({isSearching:!1}),this.setState((function(e){return{messages:e.messages.filter((function(e){return!e.content.includes(" Searching the web...")}))}})),this.addMessageToChat({id:x("search-error"),sender:"ai",content:" Web search failed: ".concat(c instanceof Error?c.message:"Unknown error",". I'll answer based on my knowledge."),timestamp:(new Date).toISOString()}),[3,5];case 5:return l=x("ai"),this.addMessageToChat({id:l,sender:"ai",content:"",timestamp:(new Date).toISOString(),isStreaming:!0}),d="",u=function(e){d+=e,b.setState((function(e){var n=e.messages.map((function(e){return e.id===l?xe(xe({},e),{content:b.cleanMessageContent(d)}):e}));return xe(xe({},e),{messages:n})}),(function(){b.state.isAutoScrollLocked?b.updateScrollState():b.scrollToBottom()}))},p=function(e){console.log(" Conversation ID received: ".concat(e)),b.setState({conversation_id:e},(function(){console.log(" Conversation ID updated in state: ".concat(b.state.conversation_id)),setTimeout((function(){b.refreshConversationsList()}),1e3)}))},h=this.getCurrentPageContext(),[4,this.aiService.sendPrompt(n,this.state.selectedModel,this.state.useStreaming,this.state.conversation_id,this.props.conversationType||"chat",u,p,h,this.state.selectedPersona||void 0,this.currentStreamingAbortController)];case 6:return v.sent(),g=this.state.isNearBottom||this.isUserNearBottom(),this.setState((function(e){return console.log(" Finalizing message with ID:",l),{messages:e.messages.map((function(e){if(e.id===l){var n=e.isCutOff;return console.log(" Finalizing message ".concat(e.id,", isCutOff: ").concat(e.isCutOff,", preserving canContinue: ").concat(n)),xe(xe({},e),{isStreaming:!1,canRegenerate:!0,canContinue:!!n})}return e})),isLoading:!1,isStreaming:!1}}),(function(){console.log(" Message finalized. Total messages: ".concat(b.state.messages.length)),g?b.scrollToBottom():b.updateScrollState(),b.focusInput(),b.state.conversation_id&&b.refreshConversationsList()})),this.currentStreamingAbortController=null,[3,8];case 7:return(m=v.sent())instanceof Error&&"AbortError"===m.name?this.setState((function(e){return{isLoading:!1,isStreaming:!1,messages:e.messages.map((function(e){return xe(xe({},e),{isStreaming:!1,canRegenerate:!0,canContinue:!!e.isStreaming||e.canContinue,isCutOff:!!e.isStreaming||e.isCutOff})}))}}),(function(){b.focusInput()})):this.setState({isLoading:!1,isStreaming:!1,error:"Error sending prompt: ".concat(m instanceof Error?m.message:"Unknown error")},(function(){b.focusInput()})),this.currentStreamingAbortController=null,[3,8];case 8:return[2]}}))}))},o.state={messages:[],inputText:"",isLoading:!1,error:"",currentTheme:"light",selectedModel:null,pendingModelKey:null,pendingModelSnapshot:null,useStreaming:!0,conversation_id:null,isLoadingHistory:!1,currentUserId:null,isInitializing:!0,conversations:[],selectedConversation:null,isUpdating:!1,models:[],isLoadingModels:!0,showModelSelection:!0,showConversationHistory:!0,personas:n.availablePersonas||[],selectedPersona:null,pendingPersonaId:null,isLoadingPersonas:!n.availablePersonas,showPersonaSelection:!0,useWebSearch:!1,isSearching:!1,isStreaming:!1,editingMessageId:null,editingContent:"",documentContext:"",isProcessingDocuments:!1,isNearBottom:!0,showScrollToBottom:!1,isAutoScrollLocked:!1,showAllHistory:!1,openConversationMenu:null,isHistoryExpanded:!0},o.debouncedScrollToBottom=(t=function(e){return o.scrollToBottom(e)},function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];clearTimeout(r),r=setTimeout((function(){return t.apply(void 0,e)}),100)}),o.aiService=new ce(n.services),o.searchService=new pe(n.services.api),o.documentService=new me(n.services.api),o}return ye(n,e),n.prototype.componentDidMount=function(){var e,n,t=this;console.log(" ComponentDidMount - Initial persona state: selectedPersona=".concat((null===(e=this.state.selectedPersona)||void 0===e?void 0:e.name)||"null",", showPersonaSelection=").concat(this.state.showPersonaSelection,", availablePersonas=").concat((null===(n=this.props.availablePersonas)||void 0===n?void 0:n.length)||0)),this.initializeThemeService(),this.initializePageContextService(),this.loadInitialData(),this.loadSavedStreamingMode(),this.loadPersonas(),document.addEventListener("keydown",this.handleGlobalKeyPress),document.addEventListener("mousedown",this.handleClickOutside),this.updateScrollState(),setTimeout((function(){if(!t.state.conversation_id){var e=t.state.showPersonaSelection?t.state.selectedPersona:null,n=t.state.showPersonaSelection&&(null==e?void 0:e.sample_greeting),r=n||t.props.initialGreeting;if(console.log(" Greeting logic: showPersonaSelection=".concat(t.state.showPersonaSelection,", effectivePersona=").concat((null==e?void 0:e.name)||"none",", using=").concat(n?"persona":"default"," greeting")),r&&!t.initialGreetingAdded){t.initialGreetingAdded=!0;var o={id:x("greeting"),sender:"ai",content:r,timestamp:(new Date).toISOString()};t.setState((function(e){return{messages:ke(ke([],e.messages,!0),[o],!1),isInitializing:!1}}))}else t.setState({isInitializing:!1})}}),2e3)},n.prototype.componentDidUpdate=function(e,n){if(n.models===this.state.models&&n.pendingModelKey===this.state.pendingModelKey&&n.pendingModelSnapshot===this.state.pendingModelSnapshot&&n.selectedModel===this.state.selectedModel||this.resolvePendingModelSelection(),n.personas===this.state.personas&&n.pendingPersonaId===this.state.pendingPersonaId&&n.selectedPersona===this.state.selectedPersona&&n.showPersonaSelection===this.state.showPersonaSelection||this.resolvePendingPersonaSelection(),n.messages!==this.state.messages){var t=this.state.messages.length>n.messages.length;!this.state.isAutoScrollLocked&&t?this.debouncedScrollToBottom():this.updateScrollState()}},n.prototype.componentWillUnmount=function(){var e;this.themeChangeListener&&(null===(e=this.props.services)||void 0===e?void 0:e.theme)&&this.props.services.theme.removeThemeChangeListener(this.themeChangeListener),this.pageContextUnsubscribe&&this.pageContextUnsubscribe(),document.removeEventListener("keydown",this.handleGlobalKeyPress),document.removeEventListener("mousedown",this.handleClickOutside),this.currentStreamingAbortController&&this.currentStreamingAbortController.abort()},n.prototype.getSettingKey=function(e){var n=this.getCurrentPageContext();return(null==n?void 0:n.pageId)?"page_".concat(n.pageId,"_").concat(e):e},n.prototype.getCurrentPageContext=function(){var e;return(null===(e=this.props.services)||void 0===e?void 0:e.pageContext)?this.props.services.pageContext.getCurrentPageContext():this.currentPageContext},n.prototype.getModelKey=function(e,n){var t=(e||"").trim(),r=(n||"").trim();return"".concat(r,":::").concat(t)},n.prototype.getModelKeyFromInfo=function(e){return e?this.getModelKey(e.name,e.serverName):""},n.prototype.render=function(){var e=this,n=this.state,t=n.inputText,o=n.messages,a=n.isLoading,s=n.isLoadingHistory,i=(n.useStreaming,n.error),c=n.isInitializing,l=n.models,d=n.isLoadingModels,u=n.selectedModel,p=n.conversations,h=n.selectedConversation,g=n.showModelSelection,m=(n.showConversationHistory,n.personas),f=n.selectedPersona,b=(n.isLoadingPersonas,n.showPersonaSelection),v=n.useWebSearch,y=(n.isSearching,this.props.promptQuestion),x="dark"===this.state.currentTheme?"dark-theme":"";return(0,r.jsx)("div",{className:"braindrive-chat-container ".concat(x),children:(0,r.jsxs)("div",{className:"chat-paper",children:[(0,r.jsx)(K,{models:l,selectedModel:u,isLoadingModels:d,onModelChange:this.handleModelChange,showModelSelection:g,personas:m,selectedPersona:f,onPersonaChange:this.handlePersonaChange,showPersonaSelection:b,conversations:p,selectedConversation:h,onConversationSelect:this.handleConversationSelect,onNewChatClick:this.handleNewChatClick,showConversationHistory:!0,onRenameSelectedConversation:function(n){return e.handleRenameConversation(n)},onDeleteSelectedConversation:function(n){return e.handleDeleteConversation(n)},isLoading:a,isLoadingHistory:s}),c?(0,r.jsx)(oe,{isInitializing:c}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"chat-history-container",children:(0,r.jsx)(ne,{messages:o,isLoading:a,isLoadingHistory:s,error:i,chatHistoryRef:this.chatHistoryRef,editingMessageId:this.state.editingMessageId,editingContent:this.state.editingContent,onStartEditing:this.startEditingMessage,onCancelEditing:this.cancelEditingMessage,onSaveEditing:this.saveEditedMessage,onEditingContentChange:function(n){return e.setState({editingContent:n})},onRegenerateResponse:this.regenerateResponse,onContinueGeneration:this.continueGeneration,showScrollToBottom:this.state.showScrollToBottom,onScrollToBottom:function(){return e.scrollToBottom({behavior:"smooth",manual:!0})},onToggleMarkdown:this.toggleMarkdownView,onScroll:this.handleScroll})}),(0,r.jsx)(re,{inputText:t,isLoading:a,isLoadingHistory:s,isStreaming:this.state.isStreaming,selectedModel:u,promptQuestion:y,onInputChange:this.handleInputChange,onKeyPress:this.handleKeyPress,onSendMessage:this.handleSendMessage,onStopGeneration:this.stopGeneration,onFileUpload:this.handleFileUploadClick,onToggleWebSearch:this.toggleWebSearchMode,useWebSearch:v,inputRef:this.inputRef,personas:m,selectedPersona:f,onPersonaChange:this.handlePersonaChange,onPersonaToggle:this.handlePersonaToggle,showPersonaSelection:!1})]})]})})},n}(a().Component);Ce.version="1.0.1";const je=Ce;var Me="1.0.0"},6768:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,"/* Message and Content Styles for BrainDriveChat */\n\n/* Message styles */\n.message {\n  display: flex;\n  width: 100%;\n}\n\n.message-user {\n  justify-content: flex-end;\n}\n\n.message-ai {\n  justify-content: flex-start;\n}\n\n.message-bubble {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n  max-width: min(720px, 88%);\n  width: fit-content;\n  padding: 1rem 1.25rem;\n  border-radius: 1rem;\n  border: 1px solid var(--border-color);\n  background-color: var(--input-bg);\n  box-shadow: 0 12px 32px rgba(15, 23, 42, 0.06);\n  transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease, border-color 0.2s ease;\n}\n\n.message-ai .message-bubble:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 16px 40px rgba(15, 23, 42, 0.1);\n}\n\n.message-user .message-bubble {\n  background-color: rgba(0, 0, 0, 0.05);\n  border-color: rgba(0, 0, 0, 0.12);\n  box-shadow: none;\n  color: var(--text-color);\n}\n\n.message-user .message-bubble:hover {\n  transform: translateY(-1px);\n}\n\n.message-body {\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n.message-content {\n  word-break: break-word;\n  white-space: pre-wrap;\n  line-height: 1.6;\n  font-size: 0.95rem;\n  color: var(--text-color);\n}\n\n.message-text {\n  white-space: pre-wrap;\n}\n\n.user-message-text {\n  font-weight: 500;\n}\n\n.message-meta {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 0.5rem 1rem;\n  color: var(--text-color);\n  opacity: 0.8;\n  font-size: 0.75rem;\n}\n\n.message-meta .message-timestamp {\n  font-size: 0.75rem;\n  opacity: 0.9;\n}\n\n.message-meta .message-edited-indicator {\n  font-style: italic;\n  opacity: 0.7;\n}\n\n.message-meta .message-actions {\n  display: flex;\n  align-items: center;\n  gap: 0.25rem;\n  margin-left: auto;\n}\n\n.message-action-btn {\n  background-color: rgba(33, 150, 243, 0.06);\n  border: 1px solid var(--border-color);\n  cursor: pointer;\n  padding: 0.35rem;\n  border-radius: 0.5rem;\n  font-size: 0.875rem;\n  opacity: 0.85;\n  transition: transform 0.18s ease, background-color 0.18s ease, border-color 0.18s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 28px;\n  height: 28px;\n}\n\n.message-action-btn:hover {\n  opacity: 1;\n  background-color: rgba(33, 150, 243, 0.12);\n  border-color: rgba(33, 150, 243, 0.45);\n  transform: translateY(-1px);\n}\n\n.ai-message-actions {\n  display: flex;\n  gap: 0.25rem;\n}\n\n.message-streaming .message-bubble {\n  border-color: rgba(33, 150, 243, 0.4);\n  box-shadow: 0 10px 28px rgba(33, 150, 243, 0.15);\n}\n\n/* Message editing styles */\n.message-edit-container {\n  width: 100%;\n}\n\n.message-edit-input {\n  width: 100%;\n  padding: 0.75rem;\n  border: 1px solid var(--button-primary-bg);\n  border-radius: 0.5rem;\n  background-color: var(--input-bg);\n  color: var(--button-secondary-text);\n  font-size: 0.9rem;\n  resize: vertical;\n  min-height: 2.75rem;\n  font-family: inherit;\n  line-height: 1.5;\n}\n\n.message-edit-input:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n.message-edit-actions {\n  display: flex;\n  gap: 0.5rem;\n  margin-top: 0.75rem;\n  justify-content: flex-end;\n}\n\n.message-edited-indicator {\n  font-size: 0.75rem;\n  opacity: 0.7;\n  font-style: italic;\n}\n\n/* Search Results Message Styles */\n.message-search-results .message-bubble {\n  background-color: rgba(33, 150, 243, 0.05);\n  border-color: rgba(33, 150, 243, 0.2);\n}\n\n.search-results-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1rem;\n  margin-bottom: 0.5rem;\n}\n\n.search-results-summary {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  flex: 1;\n  min-width: 0;\n}\n\n.search-icon {\n  font-size: 1rem;\n  opacity: 0.8;\n}\n\n.search-query {\n  font-weight: 500;\n  color: var(--text-color);\n  font-style: italic;\n}\n\n.search-count {\n  font-size: 0.875rem;\n  color: var(--text-color);\n  opacity: 0.7;\n}\n\n.scraping-info {\n  font-size: 0.75rem;\n  color: var(--text-color);\n  opacity: 0.6;\n  background-color: rgba(76, 175, 80, 0.1);\n  padding: 0.125rem 0.375rem;\n  border-radius: 0.25rem;\n}\n\n.search-toggle-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.375rem;\n  background: none;\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  padding: 0.375rem 0.75rem;\n  font-size: 0.875rem;\n  color: var(--text-color);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n  flex-shrink: 0;\n}\n\n.search-toggle-btn:hover {\n  background-color: var(--border-color);\n  transform: translateY(-1px);\n}\n\n.search-toggle-btn:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n.search-toggle-icon {\n  font-size: 0.75rem;\n  transition: transform 0.2s ease;\n}\n\n.search-toggle-text {\n  font-weight: 500;\n}\n\n.search-results-content {\n  border-top: 1px solid var(--border-color);\n  padding-top: 0.75rem;\n  margin-top: 0.5rem;\n  animation: slideDown 0.3s ease-out;\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    max-height: 0;\n    overflow: hidden;\n  }\n  to {\n    opacity: 1;\n    max-height: 1000px;\n    overflow: visible;\n  }\n}\n\n.search-results-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  margin-bottom: 0.75rem;\n}\n\n.search-result-item {\n  padding: 0.75rem;\n  border: 1px solid var(--border-color);\n  border-radius: 0.5rem;\n  background-color: var(--paper-bg);\n  transition: border-color 0.2s ease;\n}\n\n.search-result-item:hover {\n  border-color: var(--button-primary-bg);\n}\n\n.search-result-header {\n  display: flex;\n  align-items: flex-start;\n  gap: 0.5rem;\n  margin-bottom: 0.375rem;\n}\n\n.search-result-number {\n  font-weight: 600;\n  color: var(--button-primary-bg);\n  font-size: 0.875rem;\n  min-width: 1.5rem;\n}\n\n.search-result-title {\n  color: var(--button-primary-bg);\n  text-decoration: none;\n  font-weight: 500;\n  line-height: 1.4;\n  word-break: break-word;\n}\n\n.search-result-title:hover {\n  text-decoration: underline;\n}\n\n.search-result-url {\n  font-size: 0.75rem;\n  color: var(--text-color);\n  opacity: 0.7;\n  margin-bottom: 0.5rem;\n  word-break: break-all;\n  font-family: monospace;\n}\n\n.search-result-content {\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: var(--text-color);\n  opacity: 0.9;\n}\n\n.scraping-summary {\n  padding: 0.75rem;\n  background-color: rgba(76, 175, 80, 0.05);\n  border: 1px solid rgba(76, 175, 80, 0.2);\n  border-radius: 0.5rem;\n}\n\n.scraping-header {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.875rem;\n  color: var(--text-color);\n  opacity: 0.8;\n}\n\n.scraping-icon {\n  font-size: 1rem;\n}\n\n/* Document Context Message Styles */\n.message-document-context .message-bubble {\n  background-color: rgba(76, 175, 80, 0.05);\n  border-color: rgba(76, 175, 80, 0.2);\n}\n\n.document-context-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 1rem;\n  margin-bottom: 0.5rem;\n}\n\n.document-context-summary {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  flex: 1;\n  min-width: 0;\n}\n\n.document-icon {\n  font-size: 1rem;\n  opacity: 0.8;\n}\n\n.document-filename {\n  font-weight: 500;\n  color: var(--text-color);\n  font-style: italic;\n}\n\n.document-info {\n  font-size: 0.875rem;\n  color: var(--text-color);\n  opacity: 0.7;\n}\n\n.document-toggle-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.375rem;\n  background: none;\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  padding: 0.375rem 0.75rem;\n  font-size: 0.875rem;\n  color: var(--text-color);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n  flex-shrink: 0;\n}\n\n.document-toggle-btn:hover {\n  background-color: var(--border-color);\n  transform: translateY(-1px);\n}\n\n.document-toggle-btn:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n.document-toggle-icon {\n  font-size: 0.75rem;\n  transition: transform 0.2s ease;\n}\n\n.document-toggle-text {\n  font-weight: 500;\n}\n\n.document-context-content {\n  border-top: 1px solid var(--border-color);\n  padding-top: 0.75rem;\n  margin-top: 0.5rem;\n  animation: slideDown 0.3s ease-out;\n}\n\n.document-content {\n  font-family: monospace;\n  font-size: 0.875rem;\n  line-height: 1.5;\n  color: var(--text-color);\n  opacity: 0.9;\n  white-space: pre-wrap;\n  word-break: break-word;\n  max-height: 300px;\n  overflow-y: auto;\n  padding: 0.75rem;\n  background-color: var(--paper-bg);\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n}\n\n/* Animation keyframes */\n@keyframes blink {\n  50% { opacity: 0; }\n}\n\n/* Typing indicator */\n.typing-indicator {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.25rem;\n  height: 1.25rem;\n  padding: 0 0.25rem;\n  align-self: flex-start;\n}\n\n.typing-dot {\n  width: 0.375rem;\n  height: 0.375rem;\n  border-radius: 50%;\n  background-color: var(--text-color);\n  opacity: 0.7;\n  animation: typingPulse 1.5s infinite ease-in-out;\n}\n\n.typing-dot:nth-child(2) {\n  animation-delay: 0.2s;\n}\n\n.typing-dot:nth-child(3) {\n  animation-delay: 0.4s;\n}\n\n@keyframes typingPulse {\n  0%, 100% { transform: scale(0.8); opacity: 0.5; }\n  50% { transform: scale(1.2); opacity: 1; }\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .message-bubble,\n  .message-body .thinking-block .thinking-panel {\n    transition: none !important;\n  }\n}\n\n/* Loading indicator */\n.loading-indicator {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0.5rem;\n}\n\n.loading-dots {\n  display: flex;\n  gap: 0.25rem;\n}\n\n.loading-dot {\n  width: 0.5rem;\n  height: 0.5rem;\n  border-radius: 50%;\n  background-color: var(--text-color);\n  opacity: 0.7;\n  animation: pulse 1.5s infinite ease-in-out;\n}\n\n.loading-dot:nth-child(2) {\n  animation-delay: 0.2s;\n}\n\n.loading-dot:nth-child(3) {\n  animation-delay: 0.4s;\n}\n\n@keyframes pulse {\n  0%, 100% { transform: scale(0.8); opacity: 0.5; }\n  50% { transform: scale(1.2); opacity: 1; }\n}\n\n/* Error message */\n.error-message {\n  color: var(--status-error-color);\n  padding: 0.5rem 0.75rem;\n  margin: 0.5rem 0;\n  border-radius: 0.25rem;\n  background-color: rgba(244, 67, 54, 0.1);\n  border-left: 3px solid var(--status-error-color);\n}\n\n/* Empty state */\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: var(--text-color);\n  opacity: 0.7;\n  text-align: center;\n  padding: 1.25rem;\n}\n\n.empty-state-icon {\n  font-size: 3rem;\n  margin-bottom: 1rem;\n}\n\n.empty-state-text {\n  font-size: 1rem;\n  max-width: 18.75rem;\n}\n\n/* Markdown styles - MINIMAL SPACING */\n.message-content p {\n  margin: 0 !important;\n  line-height: 1.3 !important;\n  padding: 0 !important;\n}\n\n.message-content p:first-child {\n  margin-top: 0 !important;\n}\n\n.message-content p:last-child {\n  margin-bottom: 0 !important;\n}\n\n/* Minimal heading spacing */\n.message-content h1,\n.message-content h2,\n.message-content h3,\n.message-content h4,\n.message-content h5,\n.message-content h6 {\n  margin: 0.25rem 0 0.125rem 0 !important;\n  font-weight: 600 !important;\n  line-height: 1.2 !important;\n  padding: 0 !important;\n}\n\n.message-content h1 { font-size: 1.25rem !important; }\n.message-content h2 { font-size: 1.125rem !important; }\n.message-content h3 { font-size: 1rem !important; }\n.message-content h4 { font-size: 0.875rem !important; }\n.message-content h5 { font-size: 0.75rem !important; }\n.message-content h6 { font-size: 0.625rem !important; }\n\n/* Minimal list spacing */\n.message-content ul,\n.message-content ol {\n  margin: 0.25rem 0 !important;\n  padding-left: 2rem !important;\n  list-style-position: outside !important;\n  white-space: normal !important;\n}\n\n.message-content li {\n  margin: 0 !important;\n  line-height: 1.5 !important;\n  padding: 0 !important;\n  display: list-item !important;\n  white-space: normal !important;\n}\n\n/* Ensure proper list item display */\n.message-content ul li {\n  list-style-type: disc !important;\n}\n\n.message-content ol li {\n  list-style-type: decimal !important;\n}\n\n/* Remove any extra spacing between list items */\n.message-content li + li {\n  margin-top: 0 !important;\n}\n\n/* Ensure nested lists have proper indentation */\n.message-content ul ul,\n.message-content ol ol,\n.message-content ul ol,\n.message-content ol ul {\n  margin: 0 !important;\n  padding-left: 1rem !important;\n}\n\n/* Thinking tag styles - collapsible and embedded in AI responses */\n.message-body .thinking-block {\n  margin: 0.25rem 0 0;\n  border: 1px solid rgba(33, 150, 243, 0.25);\n  border-radius: 0.75rem;\n  background-color: rgba(33, 150, 243, 0.05);\n  overflow: hidden;\n  color: var(--text-color);\n  transition: border-color 0.2s ease, background-color 0.2s ease;\n}\n\n.message-body .thinking-block.thinking-streaming {\n  border-style: dashed;\n  opacity: 0.9;\n}\n\n.message-body .thinking-block .thinking-header {\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 0.5rem;\n  padding: 0.65rem 0.85rem;\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  font-weight: 600;\n  font-size: 0.85rem;\n  color: inherit;\n  transition: background-color 0.2s ease;\n}\n\n.message-body .thinking-block .thinking-header:hover {\n  background-color: rgba(33, 150, 243, 0.1);\n}\n\n.message-body .thinking-block .thinking-header:focus-visible {\n  outline: 2px solid rgba(33, 150, 243, 0.45);\n  outline-offset: 2px;\n}\n\n.message-body .thinking-block .thinking-title {\n  display: flex;\n  align-items: center;\n  gap: 0.35rem;\n}\n\n.message-body .thinking-block .thinking-toggle {\n  font-size: 0.75rem;\n  opacity: 0.6;\n  transition: transform 0.2s ease;\n}\n\n.message-body .thinking-block.expanded .thinking-toggle {\n  transform: rotate(180deg);\n}\n\n.message-body .thinking-block .thinking-panel {\n  max-height: 0;\n  overflow: hidden;\n  transition: max-height 0.24s ease;\n}\n\n.message-body .thinking-block.expanded .thinking-panel {\n  max-height: 600px;\n}\n\n.message-body .thinking-block .thinking-content {\n  padding: 0 0.85rem 0.85rem;\n  line-height: 1.45;\n  white-space: pre-wrap;\n  font-style: normal;\n}\n",""]);const i=s},7155:(e,n,t)=>{t.d(n,{A:()=>i});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a)()(o());s.push([e.id,'/* Form and Input Styles for BrainDriveChat */\n\n/* Toggle switch */\n.toggle-switch {\n  display: flex;\n  align-items: center;\n  gap: 0.375rem;\n  cursor: pointer;\n  user-select: none;\n}\n\n.toggle-switch input[type="checkbox"] {\n  appearance: none;\n  -webkit-appearance: none;\n  width: 2.25rem;\n  height: 1.125rem;\n  border-radius: 0.625rem;\n  background-color: var(--border-color);\n  position: relative;\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n}\n\n.toggle-switch input[type="checkbox"]:checked {\n  background-color: var(--button-primary-bg);\n}\n\n.toggle-switch input[type="checkbox"]::before {\n  content: \'\';\n  position: absolute;\n  width: 0.875rem;\n  height: 0.875rem;\n  border-radius: 50%;\n  background-color: white;\n  top: 0.125rem;\n  left: 0.125rem;\n  transition: transform 0.3s ease;\n}\n\n.toggle-switch input[type="checkbox"]:checked::before {\n  transform: translateX(1.125rem);\n}\n\n.toggle-switch input[type="checkbox"]:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.toggle-label {\n  font-size: 0.75rem;\n  color: var(--text-color);\n}\n\n/* Dropdown styles */\n.dropdown-container {\n  position: relative;\n  width: 100%;\n}\n\n.dropdown-select {\n  width: 100%;\n  padding: 0.5rem 0.75rem;\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  background-color: var(--input-bg);\n  color: var(--text-color);\n  cursor: pointer;\n  transition: border-color 0.3s ease;\n}\n\n.dropdown-select:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n}\n\n.dropdown-select:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Button styles */\n.btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0.5rem 1rem;\n  border-radius: 0.375rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border: none;\n  text-decoration: none;\n}\n\n.btn-primary {\n  background-color: var(--button-primary-bg);\n  color: var(--button-primary-text);\n}\n\n.btn-primary:hover {\n  opacity: 0.9;\n  transform: translateY(-1px);\n}\n\n.btn-secondary {\n  background-color: var(--button-secondary-bg);\n  color: var(--button-secondary-text);\n}\n\n.btn-secondary:hover {\n  opacity: 0.9;\n}\n\n.btn-danger {\n  background-color: var(--button-danger-bg);\n  color: var(--button-danger-text);\n}\n\n.btn-danger:hover {\n  opacity: 0.9;\n}\n\n.btn-sm {\n  padding: 0.25rem 0.5rem;\n  font-size: 0.875rem;\n}\n\n.btn-xs {\n  padding: 0.125rem 0.375rem;\n  font-size: 0.75rem;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none;\n}\n\n/* Modal Styles */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  padding: 1rem;\n}\n\n.modal-content {\n  background-color: var(--paper-bg);\n  border-radius: 0.5rem;\n  box-shadow: var(--shadow-xl);\n  width: 100%;\n  max-width: 400px;\n  max-height: 90vh;\n  overflow: hidden;\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1rem 1.25rem;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.modal-title {\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: var(--text-color);\n  margin: 0;\n}\n\n.modal-close {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  color: var(--text-color);\n  cursor: pointer;\n  padding: 0;\n  width: 24px;\n  height: 24px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 0.25rem;\n  transition: background-color 0.2s ease;\n}\n\n.modal-close:hover {\n  background-color: var(--border-color);\n}\n\n.modal-body {\n  padding: 1.25rem;\n}\n\n.modal-form {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.modal-input {\n  padding: 0.75rem;\n  border: 1px solid var(--border-color);\n  border-radius: 0.375rem;\n  background-color: var(--input-bg);\n  color: var(--text-color);\n  font-size: 0.875rem;\n  transition: border-color 0.2s ease, box-shadow 0.2s ease;\n}\n\n.modal-input:focus {\n  outline: none;\n  border-color: var(--button-primary-bg);\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\n}\n\n.modal-text {\n  color: var(--text-color);\n  line-height: 1.5;\n  margin: 0;\n}\n\n.modal-actions {\n  display: flex;\n  gap: 0.75rem;\n  justify-content: flex-end;\n}\n\n.modal-btn {\n  padding: 0.5rem 1rem;\n  border: none;\n  border-radius: 0.375rem;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  min-width: 80px;\n}\n\n.modal-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.modal-btn-primary {\n  background-color: var(--button-primary-bg);\n  color: var(--button-primary-text);\n}\n\n.modal-btn-primary:hover:not(:disabled) {\n  opacity: 0.9;\n}\n\n.modal-btn-secondary {\n  background-color: var(--button-secondary-bg);\n  color: var(--button-secondary-text);\n}\n\n.modal-btn-secondary:hover:not(:disabled) {\n  opacity: 0.9;\n}\n\n.modal-btn-danger {\n  background-color: var(--button-danger-bg);\n  color: var(--button-danger-text);\n}\n\n.modal-btn-danger:hover:not(:disabled) {\n  opacity: 0.9;\n}\n\n/* File Upload Component Styles */\n.file-upload-container {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  margin-bottom: 1rem;\n}\n\n.file-upload-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1rem;\n  background-color: var(--button-secondary-bg);\n  color: var(--button-secondary-text);\n  border: 2px dashed var(--border-color);\n  border-radius: 0.5rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 0.875rem;\n  font-weight: 500;\n}\n\n.file-upload-button:hover:not(:disabled) {\n  background-color: var(--border-color);\n  border-color: var(--button-primary-bg);\n  transform: translateY(-1px);\n}\n\n.file-upload-button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.file-upload-loading {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.loading-spinner {\n  width: 16px;\n  height: 16px;\n  border: 2px solid var(--border-color);\n  border-top: 2px solid var(--button-primary-bg);\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.file-upload-info {\n  text-align: center;\n  color: var(--text-color);\n  opacity: 0.7;\n}\n\n.file-upload-info small {\n  font-size: 0.75rem;\n}\n',""]);const i=s},7492:(e,n,t)=>{t.d(n,{A:()=>f});var r=t(1601),o=t.n(r),a=t(6314),s=t.n(a),i=t(4103),c=t(4638),l=t(2460),d=t(6768),u=t(7155),p=t(3915),h=t(2146),g=t(4658),m=s()(o());m.i(i.A),m.i(c.A),m.i(l.A),m.i(d.A),m.i(u.A),m.i(p.A),m.i(h.A),m.i(g.A),m.push([e.id,"/* \n * BrainDriveChat - Modular CSS Architecture\n * Import all modular CSS files for better organization and maintainability\n */\n\n/* Base styles: variables, reset, utilities */\n\n/* Layout: main container, flexbox, grid layouts */\n\n/* Components: headers, buttons, menus, etc. */\n\n/* Messages: chat messages, search results, document context */\n\n/* Forms: inputs, buttons, modals, file uploads */\n\n/* Markdown: code blocks, syntax highlighting, text formatting */\n\n/* Themes: dark mode and theme-specific overrides */\n\n/* Responsive: media queries for different screen sizes */",""]);const f=m}}]);